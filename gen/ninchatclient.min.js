"use strict";
(function() {

Error.stackTraceLimit=Infinity;var $global,$module;if(typeof window!=="undefined"){$global=window;}else if(typeof self!=="undefined"){$global=self;}else if(typeof global!=="undefined"){$global=global;$global.require=require;}else{$global=this;}if($global===undefined||$global.Array===undefined){throw new Error("no global object found");}if(typeof module!=="undefined"){$module=module;}var $packages={},$idCounter=0;var $keys=function(m){return m?Object.keys(m):[];};var $min=Math.min;var $mod=function(x,y){return x%y;};var $parseInt=parseInt;var $parseFloat=function(f){if(f!==undefined&&f!==null&&f.constructor===Number){return f;}return parseFloat(f);};var $flushConsole=function(){};var $throwRuntimeError;var $throwNilPointerError=function(){$throwRuntimeError("invalid memory address or nil pointer dereference");};var $call=function(fn,rcvr,args){return fn.apply(rcvr,args);};var $makeFunc=function(fn){return function(){return fn(new($sliceType($jsObjectPtr))($global.Array.prototype.slice.call(arguments,[])));}};var $froundBuf=new Float32Array(1);var $fround=Math.fround||function(f){$froundBuf[0]=f;return $froundBuf[0];};var $mapArray=function(array,f){var newArray=new array.constructor(array.length);for(var i=0;i<array.length;i++){newArray[i]=f(array[i]);}return newArray;};var $methodVal=function(recv,name){var vals=recv.$methodVals||{};recv.$methodVals=vals;var f=vals[name];if(f!==undefined){return f;}var method=recv[name];f=function(){$stackDepthOffset--;try{return method.apply(recv,arguments);}finally{$stackDepthOffset++;}};vals[name]=f;return f;};var $methodExpr=function(method){if(method.$expr===undefined){method.$expr=function(){$stackDepthOffset--;try{return Function.call.apply(method,arguments);}finally{$stackDepthOffset++;}};}return method.$expr;};var $subslice=function(slice,low,high,max){if(low<0||high<low||max<high||high>slice.$capacity||max>slice.$capacity){$throwRuntimeError("slice bounds out of range");}var s=new slice.constructor(slice.$array);s.$offset=slice.$offset+low;s.$length=slice.$length-low;s.$capacity=slice.$capacity-low;if(high!==undefined){s.$length=high-low;}if(max!==undefined){s.$capacity=max-low;}return s;};var $sliceToArray=function(slice){if(slice.$length===0){return[];}if(slice.$array.constructor!==Array){return slice.$array.subarray(slice.$offset,slice.$offset+slice.$length);}return slice.$array.slice(slice.$offset,slice.$offset+slice.$length);};var $decodeRune=function(str,pos){var c0=str.charCodeAt(pos);if(c0<0x80){return[c0,1];}if(c0!==c0||c0<0xC0){return[0xFFFD,1];}var c1=str.charCodeAt(pos+1);if(c1!==c1||c1<0x80||0xC0<=c1){return[0xFFFD,1];}if(c0<0xE0){var r=(c0&0x1F)<<6|(c1&0x3F);if(r<=0x7F){return[0xFFFD,1];}return[r,2];}var c2=str.charCodeAt(pos+2);if(c2!==c2||c2<0x80||0xC0<=c2){return[0xFFFD,1];}if(c0<0xF0){var r=(c0&0x0F)<<12|(c1&0x3F)<<6|(c2&0x3F);if(r<=0x7FF){return[0xFFFD,1];}if(0xD800<=r&&r<=0xDFFF){return[0xFFFD,1];}return[r,3];}var c3=str.charCodeAt(pos+3);if(c3!==c3||c3<0x80||0xC0<=c3){return[0xFFFD,1];}if(c0<0xF8){var r=(c0&0x07)<<18|(c1&0x3F)<<12|(c2&0x3F)<<6|(c3&0x3F);if(r<=0xFFFF||0x10FFFF<r){return[0xFFFD,1];}return[r,4];}return[0xFFFD,1];};var $encodeRune=function(r){if(r<0||r>0x10FFFF||(0xD800<=r&&r<=0xDFFF)){r=0xFFFD;}if(r<=0x7F){return String.fromCharCode(r);}if(r<=0x7FF){return String.fromCharCode(0xC0|r>>6,0x80|(r&0x3F));}if(r<=0xFFFF){return String.fromCharCode(0xE0|r>>12,0x80|(r>>6&0x3F),0x80|(r&0x3F));}return String.fromCharCode(0xF0|r>>18,0x80|(r>>12&0x3F),0x80|(r>>6&0x3F),0x80|(r&0x3F));};var $stringToBytes=function(str){var array=new Uint8Array(str.length);for(var i=0;i<str.length;i++){array[i]=str.charCodeAt(i);}return array;};var $bytesToString=function(slice){if(slice.$length===0){return"";}var str="";for(var i=0;i<slice.$length;i+=10000){str+=String.fromCharCode.apply(undefined,slice.$array.subarray(slice.$offset+i,slice.$offset+Math.min(slice.$length,i+10000)));}return str;};var $stringToRunes=function(str){var array=new Int32Array(str.length);var rune,j=0;for(var i=0;i<str.length;i+=rune[1],j++){rune=$decodeRune(str,i);array[j]=rune[0];}return array.subarray(0,j);};var $runesToString=function(slice){if(slice.$length===0){return"";}var str="";for(var i=0;i<slice.$length;i++){str+=$encodeRune(slice.$array[slice.$offset+i]);}return str;};var $copyString=function(dst,src){var n=Math.min(src.length,dst.$length);for(var i=0;i<n;i++){dst.$array[dst.$offset+i]=src.charCodeAt(i);}return n;};var $copySlice=function(dst,src){var n=Math.min(src.$length,dst.$length);$internalCopy(dst.$array,src.$array,dst.$offset,src.$offset,n,dst.constructor.elem);return n;};var $copy=function(dst,src,typ){switch(typ.kind){case $kindArray:$internalCopy(dst,src,0,0,src.length,typ.elem);break;case $kindStruct:for(var i=0;i<typ.fields.length;i++){var f=typ.fields[i];switch(f.typ.kind){case $kindArray:case $kindStruct:$copy(dst[f.prop],src[f.prop],f.typ);continue;default:dst[f.prop]=src[f.prop];continue;}}break;}};var $internalCopy=function(dst,src,dstOffset,srcOffset,n,elem){if(n===0||(dst===src&&dstOffset===srcOffset)){return;}if(src.subarray){dst.set(src.subarray(srcOffset,srcOffset+n),dstOffset);return;}switch(elem.kind){case $kindArray:case $kindStruct:if(dst===src&&dstOffset>srcOffset){for(var i=n-1;i>=0;i--){$copy(dst[dstOffset+i],src[srcOffset+i],elem);}return;}for(var i=0;i<n;i++){$copy(dst[dstOffset+i],src[srcOffset+i],elem);}return;}if(dst===src&&dstOffset>srcOffset){for(var i=n-1;i>=0;i--){dst[dstOffset+i]=src[srcOffset+i];}return;}for(var i=0;i<n;i++){dst[dstOffset+i]=src[srcOffset+i];}};var $clone=function(src,type){var clone=type.zero();$copy(clone,src,type);return clone;};var $pointerOfStructConversion=function(obj,type){if(obj.$proxies===undefined){obj.$proxies={};obj.$proxies[obj.constructor.string]=obj;}var proxy=obj.$proxies[type.string];if(proxy===undefined){var properties={};for(var i=0;i<type.elem.fields.length;i++){(function(fieldProp){properties[fieldProp]={get:function(){return obj[fieldProp];},set:function(value){obj[fieldProp]=value;},};})(type.elem.fields[i].prop);}proxy=Object.create(type.prototype,properties);proxy.$val=proxy;obj.$proxies[type.string]=proxy;proxy.$proxies=obj.$proxies;}return proxy;};var $append=function(slice){return $internalAppend(slice,arguments,1,arguments.length-1);};var $appendSlice=function(slice,toAppend){return $internalAppend(slice,toAppend.$array,toAppend.$offset,toAppend.$length);};var $internalAppend=function(slice,array,offset,length){if(length===0){return slice;}var newArray=slice.$array;var newOffset=slice.$offset;var newLength=slice.$length+length;var newCapacity=slice.$capacity;if(newLength>newCapacity){newOffset=0;newCapacity=Math.max(newLength,slice.$capacity<1024?slice.$capacity*2:Math.floor(slice.$capacity*5/4));if(slice.$array.constructor===Array){newArray=slice.$array.slice(slice.$offset,slice.$offset+slice.$length);newArray.length=newCapacity;var zero=slice.constructor.elem.zero;for(var i=slice.$length;i<newCapacity;i++){newArray[i]=zero();}}else{newArray=new slice.$array.constructor(newCapacity);newArray.set(slice.$array.subarray(slice.$offset,slice.$offset+slice.$length));}}$internalCopy(newArray,array,newOffset+slice.$length,offset,length,slice.constructor.elem);var newSlice=new slice.constructor(newArray);newSlice.$offset=newOffset;newSlice.$length=newLength;newSlice.$capacity=newCapacity;return newSlice;};var $equal=function(a,b,type){if(type===$jsObjectPtr){return a===b;}switch(type.kind){case $kindComplex64:case $kindComplex128:return a.$real===b.$real&&a.$imag===b.$imag;case $kindInt64:case $kindUint64:return a.$high===b.$high&&a.$low===b.$low;case $kindArray:if(a.length!==b.length){return false;}for(var i=0;i<a.length;i++){if(!$equal(a[i],b[i],type.elem)){return false;}}return true;case $kindStruct:for(var i=0;i<type.fields.length;i++){var f=type.fields[i];if(!$equal(a[f.prop],b[f.prop],f.typ)){return false;}}return true;case $kindInterface:return $interfaceIsEqual(a,b);default:return a===b;}};var $interfaceIsEqual=function(a,b){if(a===$ifaceNil||b===$ifaceNil){return a===b;}if(a.constructor!==b.constructor){return false;}if(!a.constructor.comparable){$throwRuntimeError("comparing uncomparable type "+a.constructor.string);}return $equal(a.$val,b.$val,a.constructor);};var $kindBool=1;var $kindInt=2;var $kindInt8=3;var $kindInt16=4;var $kindInt32=5;var $kindInt64=6;var $kindUint=7;var $kindUint8=8;var $kindUint16=9;var $kindUint32=10;var $kindUint64=11;var $kindUintptr=12;var $kindFloat32=13;var $kindFloat64=14;var $kindComplex64=15;var $kindComplex128=16;var $kindArray=17;var $kindChan=18;var $kindFunc=19;var $kindInterface=20;var $kindMap=21;var $kindPtr=22;var $kindSlice=23;var $kindString=24;var $kindStruct=25;var $kindUnsafePointer=26;var $methodSynthesizers=[];var $addMethodSynthesizer=function(f){if($methodSynthesizers===null){f();return;}$methodSynthesizers.push(f);};var $synthesizeMethods=function(){$methodSynthesizers.forEach(function(f){f();});$methodSynthesizers=null;};var $newType=function(size,kind,string,name,pkg,constructor){var typ;switch(kind){case $kindBool:case $kindInt:case $kindInt8:case $kindInt16:case $kindInt32:case $kindUint:case $kindUint8:case $kindUint16:case $kindUint32:case $kindUintptr:case $kindString:case $kindUnsafePointer:typ=function(v){this.$val=v;};typ.prototype.$key=function(){return string+"$"+this.$val;};break;case $kindFloat32:case $kindFloat64:typ=function(v){this.$val=v;};typ.prototype.$key=function(){return string+"$"+$floatKey(this.$val);};break;case $kindInt64:typ=function(high,low){this.$high=(high+Math.floor(Math.ceil(low)/4294967296))>>0;this.$low=low>>>0;this.$val=this;};typ.prototype.$key=function(){return string+"$"+this.$high+"$"+this.$low;};break;case $kindUint64:typ=function(high,low){this.$high=(high+Math.floor(Math.ceil(low)/4294967296))>>>0;this.$low=low>>>0;this.$val=this;};typ.prototype.$key=function(){return string+"$"+this.$high+"$"+this.$low;};break;case $kindComplex64:typ=function(real,imag){this.$real=$fround(real);this.$imag=$fround(imag);this.$val=this;};typ.prototype.$key=function(){return string+"$"+this.$real+"$"+this.$imag;};break;case $kindComplex128:typ=function(real,imag){this.$real=real;this.$imag=imag;this.$val=this;};typ.prototype.$key=function(){return string+"$"+this.$real+"$"+this.$imag;};break;case $kindArray:typ=function(v){this.$val=v;};typ.ptr=$newType(4,$kindPtr,"*"+string,"","",function(array){this.$get=function(){return array;};this.$set=function(v){$copy(this,v,typ);};this.$val=array;});typ.init=function(elem,len){typ.elem=elem;typ.len=len;typ.comparable=elem.comparable;typ.prototype.$key=function(){return string+"$"+Array.prototype.join.call($mapArray(this.$val,function(e){var key=e.$key?e.$key():String(e);return key.replace(/\\/g,"\\\\").replace(/\$/g,"\\$");}),"$");};typ.ptr.init(typ);Object.defineProperty(typ.ptr.nil,"nilCheck",{get:$throwNilPointerError});};break;case $kindChan:typ=function(capacity){this.$val=this;this.$capacity=capacity;this.$buffer=[];this.$sendQueue=[];this.$recvQueue=[];this.$closed=false;};typ.prototype.$key=function(){if(this.$id===undefined){$idCounter++;this.$id=$idCounter;}return String(this.$id);};typ.init=function(elem,sendOnly,recvOnly){typ.elem=elem;typ.sendOnly=sendOnly;typ.recvOnly=recvOnly;typ.nil=new typ(0);typ.nil.$sendQueue=typ.nil.$recvQueue={length:0,push:function(){},shift:function(){return undefined;},indexOf:function(){return-1;}};};break;case $kindFunc:typ=function(v){this.$val=v;};typ.init=function(params,results,variadic){typ.params=params;typ.results=results;typ.variadic=variadic;typ.comparable=false;};break;case $kindInterface:typ={implementedBy:{},missingMethodFor:{}};typ.init=function(methods){typ.methods=methods;methods.forEach(function(m){$ifaceNil[m.prop]=$throwNilPointerError;});};break;case $kindMap:typ=function(v){this.$val=v;};typ.init=function(key,elem){typ.key=key;typ.elem=elem;typ.comparable=false;};break;case $kindPtr:typ=constructor||function(getter,setter,target){this.$get=getter;this.$set=setter;this.$target=target;this.$val=this;};typ.prototype.$key=function(){if(this.$id===undefined){$idCounter++;this.$id=$idCounter;}return String(this.$id);};typ.init=function(elem){typ.elem=elem;typ.nil=new typ($throwNilPointerError,$throwNilPointerError);};break;case $kindSlice:typ=function(array){if(array.constructor!==typ.nativeArray){array=new typ.nativeArray(array);}this.$array=array;this.$offset=0;this.$length=array.length;this.$capacity=array.length;this.$val=this;};typ.init=function(elem){typ.elem=elem;typ.comparable=false;typ.nativeArray=$nativeArray(elem.kind);typ.nil=new typ([]);};break;case $kindStruct:typ=function(v){this.$val=v;};typ.ptr=$newType(4,$kindPtr,"*"+string,"","",constructor);typ.ptr.elem=typ;typ.ptr.prototype.$get=function(){return this;};typ.ptr.prototype.$set=function(v){$copy(this,v,typ);};typ.init=function(fields){typ.fields=fields;fields.forEach(function(f){if(!f.typ.comparable){typ.comparable=false;}});typ.prototype.$key=function(){var val=this.$val;return string+"$"+$mapArray(fields,function(f){var e=val[f.prop];var key=e.$key?e.$key():String(e);return key.replace(/\\/g,"\\\\").replace(/\$/g,"\\$");}).join("$");};var properties={};fields.forEach(function(f){properties[f.prop]={get:$throwNilPointerError,set:$throwNilPointerError};});typ.ptr.nil=Object.create(constructor.prototype,properties);typ.ptr.nil.$val=typ.ptr.nil;$addMethodSynthesizer(function(){var synthesizeMethod=function(target,m,f){if(target.prototype[m.prop]!==undefined){return;}target.prototype[m.prop]=function(){var v=this.$val[f.prop];if(f.typ===$jsObjectPtr){v=new $jsObjectPtr(v);}if(v.$val===undefined){v=new f.typ(v);}return v[m.prop].apply(v,arguments);};};fields.forEach(function(f){if(f.name===""){$methodSet(f.typ).forEach(function(m){synthesizeMethod(typ,m,f);synthesizeMethod(typ.ptr,m,f);});$methodSet($ptrType(f.typ)).forEach(function(m){synthesizeMethod(typ.ptr,m,f);});}});});};break;default:$panic(new $String("invalid kind: "+kind));}switch(kind){case $kindBool:case $kindMap:typ.zero=function(){return false;};break;case $kindInt:case $kindInt8:case $kindInt16:case $kindInt32:case $kindUint:case $kindUint8:case $kindUint16:case $kindUint32:case $kindUintptr:case $kindUnsafePointer:case $kindFloat32:case $kindFloat64:typ.zero=function(){return 0;};break;case $kindString:typ.zero=function(){return"";};break;case $kindInt64:case $kindUint64:case $kindComplex64:case $kindComplex128:var zero=new typ(0,0);typ.zero=function(){return zero;};break;case $kindChan:case $kindPtr:case $kindSlice:typ.zero=function(){return typ.nil;};break;case $kindFunc:typ.zero=function(){return $throwNilPointerError;};break;case $kindInterface:typ.zero=function(){return $ifaceNil;};break;case $kindArray:typ.zero=function(){var arrayClass=$nativeArray(typ.elem.kind);if(arrayClass!==Array){return new arrayClass(typ.len);}var array=new Array(typ.len);for(var i=0;i<typ.len;i++){array[i]=typ.elem.zero();}return array;};break;case $kindStruct:typ.zero=function(){return new typ.ptr();};break;default:$panic(new $String("invalid kind: "+kind));}typ.size=size;typ.kind=kind;typ.string=string;typ.typeName=name;typ.pkg=pkg;typ.methods=[];typ.methodSetCache=null;typ.comparable=true;return typ;};var $methodSet=function(typ){if(typ.methodSetCache!==null){return typ.methodSetCache;}var base={};var isPtr=(typ.kind===$kindPtr);if(isPtr&&typ.elem.kind===$kindInterface){typ.methodSetCache=[];return[];}var current=[{typ:isPtr?typ.elem:typ,indirect:isPtr}];var seen={};while(current.length>0){var next=[];var mset=[];current.forEach(function(e){if(seen[e.typ.string]){return;}seen[e.typ.string]=true;if(e.typ.typeName!==""){mset=mset.concat(e.typ.methods);if(e.indirect){mset=mset.concat($ptrType(e.typ).methods);}}switch(e.typ.kind){case $kindStruct:e.typ.fields.forEach(function(f){if(f.name===""){var fTyp=f.typ;var fIsPtr=(fTyp.kind===$kindPtr);next.push({typ:fIsPtr?fTyp.elem:fTyp,indirect:e.indirect||fIsPtr});}});break;case $kindInterface:mset=mset.concat(e.typ.methods);break;}});mset.forEach(function(m){if(base[m.name]===undefined){base[m.name]=m;}});current=next;}typ.methodSetCache=[];Object.keys(base).sort().forEach(function(name){typ.methodSetCache.push(base[name]);});return typ.methodSetCache;};var $Bool=$newType(1,$kindBool,"bool","bool","",null);var $Int=$newType(4,$kindInt,"int","int","",null);var $Int8=$newType(1,$kindInt8,"int8","int8","",null);var $Int16=$newType(2,$kindInt16,"int16","int16","",null);var $Int32=$newType(4,$kindInt32,"int32","int32","",null);var $Int64=$newType(8,$kindInt64,"int64","int64","",null);var $Uint=$newType(4,$kindUint,"uint","uint","",null);var $Uint8=$newType(1,$kindUint8,"uint8","uint8","",null);var $Uint16=$newType(2,$kindUint16,"uint16","uint16","",null);var $Uint32=$newType(4,$kindUint32,"uint32","uint32","",null);var $Uint64=$newType(8,$kindUint64,"uint64","uint64","",null);var $Uintptr=$newType(4,$kindUintptr,"uintptr","uintptr","",null);var $Float32=$newType(4,$kindFloat32,"float32","float32","",null);var $Float64=$newType(8,$kindFloat64,"float64","float64","",null);var $Complex64=$newType(8,$kindComplex64,"complex64","complex64","",null);var $Complex128=$newType(16,$kindComplex128,"complex128","complex128","",null);var $String=$newType(8,$kindString,"string","string","",null);var $UnsafePointer=$newType(4,$kindUnsafePointer,"unsafe.Pointer","Pointer","",null);var $nativeArray=function(elemKind){switch(elemKind){case $kindInt:return Int32Array;case $kindInt8:return Int8Array;case $kindInt16:return Int16Array;case $kindInt32:return Int32Array;case $kindUint:return Uint32Array;case $kindUint8:return Uint8Array;case $kindUint16:return Uint16Array;case $kindUint32:return Uint32Array;case $kindUintptr:return Uint32Array;case $kindFloat32:return Float32Array;case $kindFloat64:return Float64Array;default:return Array;}};var $toNativeArray=function(elemKind,array){var nativeArray=$nativeArray(elemKind);if(nativeArray===Array){return array;}return new nativeArray(array);};var $arrayTypes={};var $arrayType=function(elem,len){var string="["+len+"]"+elem.string;var typ=$arrayTypes[string];if(typ===undefined){typ=$newType(12,$kindArray,string,"","",null);$arrayTypes[string]=typ;typ.init(elem,len);}return typ;};var $chanType=function(elem,sendOnly,recvOnly){var string=(recvOnly?"<-":"")+"chan"+(sendOnly?"<- ":" ")+elem.string;var field=sendOnly?"SendChan":(recvOnly?"RecvChan":"Chan");var typ=elem[field];if(typ===undefined){typ=$newType(4,$kindChan,string,"","",null);elem[field]=typ;typ.init(elem,sendOnly,recvOnly);}return typ;};var $funcTypes={};var $funcType=function(params,results,variadic){var paramTypes=$mapArray(params,function(p){return p.string;});if(variadic){paramTypes[paramTypes.length-1]="..."+paramTypes[paramTypes.length-1].substr(2);}var string="func("+paramTypes.join(", ")+")";if(results.length===1){string+=" "+results[0].string;}else if(results.length>1){string+=" ("+$mapArray(results,function(r){return r.string;}).join(", ")+")";}var typ=$funcTypes[string];if(typ===undefined){typ=$newType(4,$kindFunc,string,"","",null);$funcTypes[string]=typ;typ.init(params,results,variadic);}return typ;};var $interfaceTypes={};var $interfaceType=function(methods){var string="interface {}";if(methods.length!==0){string="interface { "+$mapArray(methods,function(m){return(m.pkg!==""?m.pkg+".":"")+m.name+m.typ.string.substr(4);}).join("; ")+" }";}var typ=$interfaceTypes[string];if(typ===undefined){typ=$newType(8,$kindInterface,string,"","",null);$interfaceTypes[string]=typ;typ.init(methods);}return typ;};var $emptyInterface=$interfaceType([]);var $ifaceNil={$key:function(){return"nil";}};var $error=$newType(8,$kindInterface,"error","error","",null);$error.init([{prop:"Error",name:"Error",pkg:"",typ:$funcType([],[$String],false)}]);var $Map=function(){};(function(){var names=Object.getOwnPropertyNames(Object.prototype);for(var i=0;i<names.length;i++){$Map.prototype[names[i]]=undefined;}})();var $mapTypes={};var $mapType=function(key,elem){var string="map["+key.string+"]"+elem.string;var typ=$mapTypes[string];if(typ===undefined){typ=$newType(4,$kindMap,string,"","",null);$mapTypes[string]=typ;typ.init(key,elem);}return typ;};var $ptrType=function(elem){var typ=elem.ptr;if(typ===undefined){typ=$newType(4,$kindPtr,"*"+elem.string,"","",null);elem.ptr=typ;typ.init(elem);}return typ;};var $newDataPointer=function(data,constructor){if(constructor.elem.kind===$kindStruct){return data;}return new constructor(function(){return data;},function(v){data=v;});};var $indexPtr=function(array,index,constructor){array.$ptr=array.$ptr||{};return array.$ptr[index]||(array.$ptr[index]=new constructor(function(){return array[index];},function(v){array[index]=v;}));};var $sliceType=function(elem){var typ=elem.Slice;if(typ===undefined){typ=$newType(12,$kindSlice,"[]"+elem.string,"","",null);elem.Slice=typ;typ.init(elem);}return typ;};var $makeSlice=function(typ,length,capacity){capacity=capacity||length;var array=new typ.nativeArray(capacity);if(typ.nativeArray===Array){for(var i=0;i<capacity;i++){array[i]=typ.elem.zero();}}var slice=new typ(array);slice.$length=length;return slice;};var $structTypes={};var $structType=function(fields){var string="struct { "+$mapArray(fields,function(f){return f.name+" "+f.typ.string+(f.tag!==""?(" \""+f.tag.replace(/\\/g,"\\\\").replace(/"/g, "\\\"")+"\""):"");}).join("; ")+" }";if(fields.length===0){string="struct {}";}var typ=$structTypes[string];if(typ===undefined){typ=$newType(0,$kindStruct,string,"","",function(){this.$val=this;for(var i=0;i<fields.length;i++){var f=fields[i];var arg=arguments[i];this[f.prop]=arg!==undefined?arg:f.typ.zero();}});$structTypes[string]=typ;typ.init(fields);}return typ;};var $assertType=function(value,type,returnTuple){var isInterface=(type.kind===$kindInterface),ok,missingMethod="";if(value===$ifaceNil){ok=false;}else if(!isInterface){ok=value.constructor===type;}else{var valueTypeString=value.constructor.string;ok=type.implementedBy[valueTypeString];if(ok===undefined){ok=true;var valueMethodSet=$methodSet(value.constructor);var interfaceMethods=type.methods;for(var i=0;i<interfaceMethods.length;i++){var tm=interfaceMethods[i];var found=false;for(var j=0;j<valueMethodSet.length;j++){var vm=valueMethodSet[j];if(vm.name===tm.name&&vm.pkg===tm.pkg&&vm.typ===tm.typ){found=true;break;}}if(!found){ok=false;type.missingMethodFor[valueTypeString]=tm.name;break;}}type.implementedBy[valueTypeString]=ok;}if(!ok){missingMethod=type.missingMethodFor[valueTypeString];}}if(!ok){if(returnTuple){return[type.zero(),false];}$panic(new $packages["runtime"].TypeAssertionError.ptr("",(value===$ifaceNil?"":value.constructor.string),type.string,missingMethod));}if(!isInterface){value=value.$val;}if(type===$jsObjectPtr){value=value.object;}return returnTuple?[value,true]:value;};var $floatKey=function(f){if(f!==f){$idCounter++;return"NaN$"+$idCounter;}return String(f);};var $flatten64=function(x){return x.$high*4294967296+x.$low;};var $shiftLeft64=function(x,y){if(y===0){return x;}if(y<32){return new x.constructor(x.$high<<y|x.$low>>>(32-y),(x.$low<<y)>>>0);}if(y<64){return new x.constructor(x.$low<<(y-32),0);}return new x.constructor(0,0);};var $shiftRightInt64=function(x,y){if(y===0){return x;}if(y<32){return new x.constructor(x.$high>>y,(x.$low>>>y|x.$high<<(32-y))>>>0);}if(y<64){return new x.constructor(x.$high>>31,(x.$high>>(y-32))>>>0);}if(x.$high<0){return new x.constructor(-1,4294967295);}return new x.constructor(0,0);};var $shiftRightUint64=function(x,y){if(y===0){return x;}if(y<32){return new x.constructor(x.$high>>>y,(x.$low>>>y|x.$high<<(32-y))>>>0);}if(y<64){return new x.constructor(0,x.$high>>>(y-32));}return new x.constructor(0,0);};var $mul64=function(x,y){var high=0,low=0;if((y.$low&1)!==0){high=x.$high;low=x.$low;}for(var i=1;i<32;i++){if((y.$low&1<<i)!==0){high+=x.$high<<i|x.$low>>>(32-i);low+=(x.$low<<i)>>>0;}}for(var i=0;i<32;i++){if((y.$high&1<<i)!==0){high+=x.$low<<i;}}return new x.constructor(high,low);};var $div64=function(x,y,returnRemainder){if(y.$high===0&&y.$low===0){$throwRuntimeError("integer divide by zero");}var s=1;var rs=1;var xHigh=x.$high;var xLow=x.$low;if(xHigh<0){s=-1;rs=-1;xHigh=-xHigh;if(xLow!==0){xHigh--;xLow=4294967296-xLow;}}var yHigh=y.$high;var yLow=y.$low;if(y.$high<0){s*=-1;yHigh=-yHigh;if(yLow!==0){yHigh--;yLow=4294967296-yLow;}}var high=0,low=0,n=0;while(yHigh<2147483648&&((xHigh>yHigh)||(xHigh===yHigh&&xLow>yLow))){yHigh=(yHigh<<1|yLow>>>31)>>>0;yLow=(yLow<<1)>>>0;n++;}for(var i=0;i<=n;i++){high=high<<1|low>>>31;low=(low<<1)>>>0;if((xHigh>yHigh)||(xHigh===yHigh&&xLow>=yLow)){xHigh=xHigh-yHigh;xLow=xLow-yLow;if(xLow<0){xHigh--;xLow+=4294967296;}low++;if(low===4294967296){high++;low=0;}}yLow=(yLow>>>1|yHigh<<(32-1))>>>0;yHigh=yHigh>>>1;}if(returnRemainder){return new x.constructor(xHigh*rs,xLow*rs);}return new x.constructor(high*s,low*s);};var $divComplex=function(n,d){var ninf=n.$real===1/0||n.$real===-1/0||n.$imag===1/0||n.$imag===-1/0;var dinf=d.$real===1/0||d.$real===-1/0||d.$imag===1/0||d.$imag===-1/0;var nnan=!ninf&&(n.$real!==n.$real||n.$imag!==n.$imag);var dnan=!dinf&&(d.$real!==d.$real||d.$imag!==d.$imag);if(nnan||dnan){return new n.constructor(0/0,0/0);}if(ninf&&!dinf){return new n.constructor(1/0,1/0);}if(!ninf&&dinf){return new n.constructor(0,0);}if(d.$real===0&&d.$imag===0){if(n.$real===0&&n.$imag===0){return new n.constructor(0/0,0/0);}return new n.constructor(1/0,1/0);}var a=Math.abs(d.$real);var b=Math.abs(d.$imag);if(a<=b){var ratio=d.$real/d.$imag;var denom=d.$real*ratio+d.$imag;return new n.constructor((n.$real*ratio+n.$imag)/denom,(n.$imag*ratio-n.$real)/denom);}var ratio=d.$imag/d.$real;var denom=d.$imag*ratio+d.$real;return new n.constructor((n.$imag*ratio+n.$real)/denom,(n.$imag-n.$real*ratio)/denom);};var $stackDepthOffset=0;var $getStackDepth=function(){var err=new Error();if(err.stack===undefined){return undefined;}return $stackDepthOffset+err.stack.split("\n").length;};var $panicStackDepth=null,$panicValue;var $callDeferred=function(deferred,jsErr,fromPanic){if(!fromPanic&&deferred!==null&&deferred.index>=$curGoroutine.deferStack.length){throw jsErr;}if(jsErr!==null){var newErr=null;try{$curGoroutine.deferStack.push(deferred);$panic(new $jsErrorPtr(jsErr));}catch(err){newErr=err;}$curGoroutine.deferStack.pop();$callDeferred(deferred,newErr);return;}if($curGoroutine.asleep){return;}$stackDepthOffset--;var outerPanicStackDepth=$panicStackDepth;var outerPanicValue=$panicValue;var localPanicValue=$curGoroutine.panicStack.pop();if(localPanicValue!==undefined){$panicStackDepth=$getStackDepth();$panicValue=localPanicValue;}try{while(true){if(deferred===null){deferred=$curGoroutine.deferStack[$curGoroutine.deferStack.length-1];if(deferred===undefined){if(localPanicValue.Object instanceof Error){throw localPanicValue.Object;}var msg;if(localPanicValue.constructor===$String){msg=localPanicValue.$val;}else if(localPanicValue.Error!==undefined){msg=localPanicValue.Error();}else if(localPanicValue.String!==undefined){msg=localPanicValue.String();}else{msg=localPanicValue;}throw new Error(msg);}}var call=deferred.pop();if(call===undefined){$curGoroutine.deferStack.pop();if(localPanicValue!==undefined){deferred=null;continue;}return;}var r=call[0].apply(call[2],call[1]);if(r&&r.$blk!==undefined){deferred.push([r.$blk,[],r]);if(fromPanic){throw null;}return;}if(localPanicValue!==undefined&&$panicStackDepth===null){throw null;}}}finally{if(localPanicValue!==undefined){if($panicStackDepth!==null){$curGoroutine.panicStack.push(localPanicValue);}$panicStackDepth=outerPanicStackDepth;$panicValue=outerPanicValue;}$stackDepthOffset++;}};var $panic=function(value){$curGoroutine.panicStack.push(value);$callDeferred(null,null,true);};var $recover=function(){if($panicStackDepth===null||($panicStackDepth!==undefined&&$panicStackDepth!==$getStackDepth()-2)){return $ifaceNil;}$panicStackDepth=null;return $panicValue;};var $throw=function(err){throw err;};var $dummyGoroutine={asleep:false,exit:false,deferStack:[],panicStack:[],canBlock:false};var $curGoroutine=$dummyGoroutine,$totalGoroutines=0,$awakeGoroutines=0,$checkForDeadlock=true;var $go=function(fun,args,direct){$totalGoroutines++;$awakeGoroutines++;var $goroutine=function(){var rescheduled=false;try{$curGoroutine=$goroutine;var r=fun.apply(undefined,args);if(r&&r.$blk!==undefined){fun=function(){return r.$blk();};args=[];rescheduled=true;return;}$goroutine.exit=true;}catch(err){$goroutine.exit=true;throw err;}finally{$curGoroutine=$dummyGoroutine;if($goroutine.exit&&!rescheduled){$totalGoroutines--;$goroutine.asleep=true;}if($goroutine.asleep&&!rescheduled){$awakeGoroutines--;if($awakeGoroutines===0&&$totalGoroutines!==0&&$checkForDeadlock){console.error("fatal error: all goroutines are asleep - deadlock!");}}}};$goroutine.asleep=false;$goroutine.exit=false;$goroutine.deferStack=[];$goroutine.panicStack=[];$goroutine.canBlock=true;$schedule($goroutine,direct);};var $scheduled=[],$schedulerLoopActive=false;var $schedule=function(goroutine,direct){if(goroutine.asleep){goroutine.asleep=false;$awakeGoroutines++;}if(direct){goroutine();return;}$scheduled.push(goroutine);if(!$schedulerLoopActive){$schedulerLoopActive=true;setTimeout(function(){while(true){var r=$scheduled.shift();if(r===undefined){$schedulerLoopActive=false;break;}r();};},0);}};var $block=function(){if(!$curGoroutine.canBlock){$throwRuntimeError("cannot block in JavaScript callback, fix by wrapping code in goroutine");}$curGoroutine.asleep=true;};var $send=function(chan,value){if(chan.$closed){$throwRuntimeError("send on closed channel");}var queuedRecv=chan.$recvQueue.shift();if(queuedRecv!==undefined){queuedRecv([value,true]);return;}if(chan.$buffer.length<chan.$capacity){chan.$buffer.push(value);return;}var thisGoroutine=$curGoroutine;chan.$sendQueue.push(function(){$schedule(thisGoroutine);return value;});$block();return{$blk:function(){if(chan.$closed){$throwRuntimeError("send on closed channel");}},};};var $recv=function(chan){var queuedSend=chan.$sendQueue.shift();if(queuedSend!==undefined){chan.$buffer.push(queuedSend());}var bufferedValue=chan.$buffer.shift();if(bufferedValue!==undefined){return[bufferedValue,true];}if(chan.$closed){return[chan.constructor.elem.zero(),false];}var thisGoroutine=$curGoroutine;var f={$blk:function(){return this.value;}};var queueEntry=function(v){f.value=v;$schedule(thisGoroutine);};chan.$recvQueue.push(queueEntry);$block();return f;};var $close=function(chan){if(chan.$closed){$throwRuntimeError("close of closed channel");}chan.$closed=true;while(true){var queuedSend=chan.$sendQueue.shift();if(queuedSend===undefined){break;}queuedSend();}while(true){var queuedRecv=chan.$recvQueue.shift();if(queuedRecv===undefined){break;}queuedRecv([chan.constructor.elem.zero(),false]);}};var $select=function(comms){var ready=[];var selection=-1;for(var i=0;i<comms.length;i++){var comm=comms[i];var chan=comm[0];switch(comm.length){case 0:selection=i;break;case 1:if(chan.$sendQueue.length!==0||chan.$buffer.length!==0||chan.$closed){ready.push(i);}break;case 2:if(chan.$closed){$throwRuntimeError("send on closed channel");}if(chan.$recvQueue.length!==0||chan.$buffer.length<chan.$capacity){ready.push(i);}break;}}if(ready.length!==0){selection=ready[Math.floor(Math.random()*ready.length)];}if(selection!==-1){var comm=comms[selection];switch(comm.length){case 0:return[selection];case 1:return[selection,$recv(comm[0])];case 2:$send(comm[0],comm[1]);return[selection];}}var entries=[];var thisGoroutine=$curGoroutine;var f={$blk:function(){return this.selection;}};var removeFromQueues=function(){for(var i=0;i<entries.length;i++){var entry=entries[i];var queue=entry[0];var index=queue.indexOf(entry[1]);if(index!==-1){queue.splice(index,1);}}};for(var i=0;i<comms.length;i++){(function(i){var comm=comms[i];switch(comm.length){case 1:var queueEntry=function(value){f.selection=[i,value];removeFromQueues();$schedule(thisGoroutine);};entries.push([comm[0].$recvQueue,queueEntry]);comm[0].$recvQueue.push(queueEntry);break;case 2:var queueEntry=function(){if(comm[0].$closed){$throwRuntimeError("send on closed channel");}f.selection=[i];removeFromQueues();$schedule(thisGoroutine);return comm[1];};entries.push([comm[0].$sendQueue,queueEntry]);comm[0].$sendQueue.push(queueEntry);break;}})(i);}$block();return f;};var $jsObjectPtr,$jsErrorPtr;var $needsExternalization=function(t){switch(t.kind){case $kindBool:case $kindInt:case $kindInt8:case $kindInt16:case $kindInt32:case $kindUint:case $kindUint8:case $kindUint16:case $kindUint32:case $kindUintptr:case $kindFloat32:case $kindFloat64:return false;default:return t!==$jsObjectPtr;}};var $externalize=function(v,t){if(t===$jsObjectPtr){return v;}switch(t.kind){case $kindBool:case $kindInt:case $kindInt8:case $kindInt16:case $kindInt32:case $kindUint:case $kindUint8:case $kindUint16:case $kindUint32:case $kindUintptr:case $kindFloat32:case $kindFloat64:return v;case $kindInt64:case $kindUint64:return $flatten64(v);case $kindArray:if($needsExternalization(t.elem)){return $mapArray(v,function(e){return $externalize(e,t.elem);});}return v;case $kindFunc:return $externalizeFunction(v,t,false);case $kindInterface:if(v===$ifaceNil){return null;}if(v.constructor===$jsObjectPtr){return v.$val.object;}return $externalize(v.$val,v.constructor);case $kindMap:var m={};var keys=$keys(v);for(var i=0;i<keys.length;i++){var entry=v[keys[i]];m[$externalize(entry.k,t.key)]=$externalize(entry.v,t.elem);}return m;case $kindPtr:if(v===t.nil){return null;}return $externalize(v.$get(),t.elem);case $kindSlice:if($needsExternalization(t.elem)){return $mapArray($sliceToArray(v),function(e){return $externalize(e,t.elem);});}return $sliceToArray(v);case $kindString:if(v.search(/^[\x00-\x7F]*$/)!==-1){return v;}var s="",r;for(var i=0;i<v.length;i+=r[1]){r=$decodeRune(v,i);s+=String.fromCharCode(r[0]);}return s;case $kindStruct:var timePkg=$packages["time"];if(timePkg&&v.constructor===timePkg.Time.ptr){var milli=$div64(v.UnixNano(),new $Int64(0,1000000));return new Date($flatten64(milli));}var noJsObject={};var searchJsObject=function(v,t){if(t===$jsObjectPtr){return v;}switch(t.kind){case $kindPtr:if(v===t.nil){return noJsObject;}return searchJsObject(v.$get(),t.elem);case $kindStruct:var f=t.fields[0];return searchJsObject(v[f.prop],f.typ);case $kindInterface:return searchJsObject(v.$val,v.constructor);default:return noJsObject;}};var o=searchJsObject(v,t);if(o!==noJsObject){return o;}o={};for(var i=0;i<t.fields.length;i++){var f=t.fields[i];if(f.pkg!==""){continue;}o[f.name]=$externalize(v[f.prop],f.typ);}return o;}$panic(new $String("cannot externalize "+t.string));};var $externalizeFunction=function(v,t,passThis){if(v===$throwNilPointerError){return null;}if(v.$externalizeWrapper===undefined){$checkForDeadlock=false;v.$externalizeWrapper=function(){var args=[];for(var i=0;i<t.params.length;i++){if(t.variadic&&i===t.params.length-1){var vt=t.params[i].elem,varargs=[];for(var j=i;j<arguments.length;j++){varargs.push($internalize(arguments[j],vt));}args.push(new(t.params[i])(varargs));break;}args.push($internalize(arguments[i],t.params[i]));}var canBlock=$curGoroutine.canBlock;$curGoroutine.canBlock=false;try{var result=v.apply(passThis?this:undefined,args);}finally{$curGoroutine.canBlock=canBlock;}switch(t.results.length){case 0:return;case 1:return $externalize(result,t.results[0]);default:for(var i=0;i<t.results.length;i++){result[i]=$externalize(result[i],t.results[i]);}return result;}};}return v.$externalizeWrapper;};var $internalize=function(v,t,recv){if(t===$jsObjectPtr){return v;}if(t===$jsObjectPtr.elem){$panic(new $String("cannot internalize js.Object, use *js.Object instead"));}switch(t.kind){case $kindBool:return!!v;case $kindInt:return parseInt(v);case $kindInt8:return parseInt(v)<<24>>24;case $kindInt16:return parseInt(v)<<16>>16;case $kindInt32:return parseInt(v)>>0;case $kindUint:return parseInt(v);case $kindUint8:return parseInt(v)<<24>>>24;case $kindUint16:return parseInt(v)<<16>>>16;case $kindUint32:case $kindUintptr:return parseInt(v)>>>0;case $kindInt64:case $kindUint64:return new t(0,v);case $kindFloat32:case $kindFloat64:return parseFloat(v);case $kindArray:if(v.length!==t.len){$throwRuntimeError("got array with wrong size from JavaScript native");}return $mapArray(v,function(e){return $internalize(e,t.elem);});case $kindFunc:return function(){var args=[];for(var i=0;i<t.params.length;i++){if(t.variadic&&i===t.params.length-1){var vt=t.params[i].elem,varargs=arguments[i];for(var j=0;j<varargs.$length;j++){args.push($externalize(varargs.$array[varargs.$offset+j],vt));}break;}args.push($externalize(arguments[i],t.params[i]));}var result=v.apply(recv,args);switch(t.results.length){case 0:return;case 1:return $internalize(result,t.results[0]);default:for(var i=0;i<t.results.length;i++){result[i]=$internalize(result[i],t.results[i]);}return result;}};case $kindInterface:if(t.methods.length!==0){$panic(new $String("cannot internalize "+t.string));}if(v===null){return $ifaceNil;}switch(v.constructor){case Int8Array:return new($sliceType($Int8))(v);case Int16Array:return new($sliceType($Int16))(v);case Int32Array:return new($sliceType($Int))(v);case Uint8Array:return new($sliceType($Uint8))(v);case Uint16Array:return new($sliceType($Uint16))(v);case Uint32Array:return new($sliceType($Uint))(v);case Float32Array:return new($sliceType($Float32))(v);case Float64Array:return new($sliceType($Float64))(v);case Array:return $internalize(v,$sliceType($emptyInterface));case Boolean:return new $Bool(!!v);case Date:var timePkg=$packages["time"];if(timePkg){return new timePkg.Time(timePkg.Unix(new $Int64(0,0),new $Int64(0,v.getTime()*1000000)));}case Function:var funcType=$funcType([$sliceType($emptyInterface)],[$jsObjectPtr],true);return new funcType($internalize(v,funcType));case Number:return new $Float64(parseFloat(v));case String:return new $String($internalize(v,$String));default:if($global.Node&&v instanceof $global.Node){return new $jsObjectPtr(v);}var mapType=$mapType($String,$emptyInterface);return new mapType($internalize(v,mapType));}case $kindMap:var m=new $Map();var keys=$keys(v);for(var i=0;i<keys.length;i++){var key=$internalize(keys[i],t.key);m[key.$key?key.$key():key]={k:key,v:$internalize(v[keys[i]],t.elem)};}return m;case $kindPtr:if(t.elem.kind===$kindStruct){return $internalize(v,t.elem);}case $kindSlice:return new t($mapArray(v,function(e){return $internalize(e,t.elem);}));case $kindString:v=String(v);if(v.search(/^[\x00-\x7F]*$/)!==-1){return v;}var s="";for(var i=0;i<v.length;i++){s+=$encodeRune(v.charCodeAt(i));}return s;case $kindStruct:var noJsObject={};var searchJsObject=function(t){if(t===$jsObjectPtr){return v;}if(t===$jsObjectPtr.elem){$panic(new $String("cannot internalize js.Object, use *js.Object instead"));}switch(t.kind){case $kindPtr:return searchJsObject(t.elem);case $kindStruct:var f=t.fields[0];var o=searchJsObject(f.typ);if(o!==noJsObject){var n=new t.ptr();n[f.prop]=o;return n;}return noJsObject;default:return noJsObject;}};var o=searchJsObject(t);if(o!==noJsObject){return o;}}$panic(new $String("cannot internalize "+t.string));};
$packages["github.com/gopherjs/gopherjs/js"]=(function(){var $pkg={},$init,A,B,L,N,Q,K;A=$pkg.Object=$newType(0,$kindStruct,"js.Object","Object","github.com/gopherjs/gopherjs/js",function(object_){this.$val=this;if(arguments.length===0){this.object=null;return;}this.object=object_;});B=$pkg.Error=$newType(0,$kindStruct,"js.Error","Error","github.com/gopherjs/gopherjs/js",function(Object_){this.$val=this;if(arguments.length===0){this.Object=null;return;}this.Object=Object_;});L=$sliceType($emptyInterface);N=$ptrType(A);Q=$ptrType(B);A.ptr.prototype.Get=function(a){var $ptr,a,b;b=this;return b.object[$externalize(a,$String)];};A.prototype.Get=function(a){return this.$val.Get(a);};A.ptr.prototype.Set=function(a,b){var $ptr,a,b,c;c=this;c.object[$externalize(a,$String)]=$externalize(b,$emptyInterface);};A.prototype.Set=function(a,b){return this.$val.Set(a,b);};A.ptr.prototype.Delete=function(a){var $ptr,a,b;b=this;delete b.object[$externalize(a,$String)];};A.prototype.Delete=function(a){return this.$val.Delete(a);};A.ptr.prototype.Length=function(){var $ptr,a;a=this;return $parseInt(a.object.length);};A.prototype.Length=function(){return this.$val.Length();};A.ptr.prototype.Index=function(a){var $ptr,a,b;b=this;return b.object[a];};A.prototype.Index=function(a){return this.$val.Index(a);};A.ptr.prototype.SetIndex=function(a,b){var $ptr,a,b,c;c=this;c.object[a]=$externalize(b,$emptyInterface);};A.prototype.SetIndex=function(a,b){return this.$val.SetIndex(a,b);};A.ptr.prototype.Call=function(a,b){var $ptr,a,b,c,d;c=this;return(d=c.object,d[$externalize(a,$String)].apply(d,$externalize(b,L)));};A.prototype.Call=function(a,b){return this.$val.Call(a,b);};A.ptr.prototype.Invoke=function(a){var $ptr,a,b;b=this;return b.object.apply(undefined,$externalize(a,L));};A.prototype.Invoke=function(a){return this.$val.Invoke(a);};A.ptr.prototype.New=function(a){var $ptr,a,b;b=this;return new($global.Function.prototype.bind.apply(b.object,[undefined].concat($externalize(a,L))));};A.prototype.New=function(a){return this.$val.New(a);};A.ptr.prototype.Bool=function(){var $ptr,a;a=this;return!!(a.object);};A.prototype.Bool=function(){return this.$val.Bool();};A.ptr.prototype.String=function(){var $ptr,a;a=this;return $internalize(a.object,$String);};A.prototype.String=function(){return this.$val.String();};A.ptr.prototype.Int=function(){var $ptr,a;a=this;return $parseInt(a.object)>>0;};A.prototype.Int=function(){return this.$val.Int();};A.ptr.prototype.Int64=function(){var $ptr,a;a=this;return $internalize(a.object,$Int64);};A.prototype.Int64=function(){return this.$val.Int64();};A.ptr.prototype.Uint64=function(){var $ptr,a;a=this;return $internalize(a.object,$Uint64);};A.prototype.Uint64=function(){return this.$val.Uint64();};A.ptr.prototype.Float=function(){var $ptr,a;a=this;return $parseFloat(a.object);};A.prototype.Float=function(){return this.$val.Float();};A.ptr.prototype.Interface=function(){var $ptr,a;a=this;return $internalize(a.object,$emptyInterface);};A.prototype.Interface=function(){return this.$val.Interface();};A.ptr.prototype.Unsafe=function(){var $ptr,a;a=this;return a.object;};A.prototype.Unsafe=function(){return this.$val.Unsafe();};B.ptr.prototype.Error=function(){var $ptr,a;a=this;return"JavaScript error: "+$internalize(a.Object.message,$String);};B.prototype.Error=function(){return this.$val.Error();};B.ptr.prototype.Stack=function(){var $ptr,a;a=this;return $internalize(a.Object.stack,$String);};B.prototype.Stack=function(){return this.$val.Stack();};K=function(){var $ptr,a;a=new B.ptr(null);};N.methods=[{prop:"Get",name:"Get",pkg:"",typ:$funcType([$String],[N],false)},{prop:"Set",name:"Set",pkg:"",typ:$funcType([$String,$emptyInterface],[],false)},{prop:"Delete",name:"Delete",pkg:"",typ:$funcType([$String],[],false)},{prop:"Length",name:"Length",pkg:"",typ:$funcType([],[$Int],false)},{prop:"Index",name:"Index",pkg:"",typ:$funcType([$Int],[N],false)},{prop:"SetIndex",name:"SetIndex",pkg:"",typ:$funcType([$Int,$emptyInterface],[],false)},{prop:"Call",name:"Call",pkg:"",typ:$funcType([$String,L],[N],true)},{prop:"Invoke",name:"Invoke",pkg:"",typ:$funcType([L],[N],true)},{prop:"New",name:"New",pkg:"",typ:$funcType([L],[N],true)},{prop:"Bool",name:"Bool",pkg:"",typ:$funcType([],[$Bool],false)},{prop:"String",name:"String",pkg:"",typ:$funcType([],[$String],false)},{prop:"Int",name:"Int",pkg:"",typ:$funcType([],[$Int],false)},{prop:"Int64",name:"Int64",pkg:"",typ:$funcType([],[$Int64],false)},{prop:"Uint64",name:"Uint64",pkg:"",typ:$funcType([],[$Uint64],false)},{prop:"Float",name:"Float",pkg:"",typ:$funcType([],[$Float64],false)},{prop:"Interface",name:"Interface",pkg:"",typ:$funcType([],[$emptyInterface],false)},{prop:"Unsafe",name:"Unsafe",pkg:"",typ:$funcType([],[$Uintptr],false)}];Q.methods=[{prop:"Error",name:"Error",pkg:"",typ:$funcType([],[$String],false)},{prop:"Stack",name:"Stack",pkg:"",typ:$funcType([],[$String],false)}];A.init([{prop:"object",name:"object",pkg:"github.com/gopherjs/gopherjs/js",typ:N,tag:""}]);B.init([{prop:"Object",name:"",pkg:"",typ:N,tag:""}]);$init=function(){$pkg.$init=function(){};var $f,$c=false,$s=0,$r;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:K();}return;}if($f===undefined){$f={$blk:$init};}$f.$s=$s;$f.$r=$r;return $f;};$pkg.$init=$init;return $pkg;})();
$packages["runtime"]=(function(){var $pkg={},$init,A,W,Y,AQ,C;A=$packages["github.com/gopherjs/gopherjs/js"];W=$pkg.TypeAssertionError=$newType(0,$kindStruct,"runtime.TypeAssertionError","TypeAssertionError","runtime",function(interfaceString_,concreteString_,assertedString_,missingMethod_){this.$val=this;if(arguments.length===0){this.interfaceString="";this.concreteString="";this.assertedString="";this.missingMethod="";return;}this.interfaceString=interfaceString_;this.concreteString=concreteString_;this.assertedString=assertedString_;this.missingMethod=missingMethod_;});Y=$pkg.errorString=$newType(8,$kindString,"runtime.errorString","errorString","runtime",null);AQ=$ptrType(W);C=function(){var $ptr,a,b;a=$packages[$externalize("github.com/gopherjs/gopherjs/js",$String)];$jsObjectPtr=a.Object.ptr;$jsErrorPtr=a.Error.ptr;$throwRuntimeError=(function(b){var $ptr,b;$panic(new Y(b));});b=$ifaceNil;b=new W.ptr("","","","");};W.ptr.prototype.RuntimeError=function(){var $ptr;};W.prototype.RuntimeError=function(){return this.$val.RuntimeError();};W.ptr.prototype.Error=function(){var $ptr,a,b;a=this;b=a.interfaceString;if(b===""){b="interface";}if(a.concreteString===""){return"interface conversion: "+b+" is nil, not "+a.assertedString;}if(a.missingMethod===""){return"interface conversion: "+b+" is "+a.concreteString+", not "+a.assertedString;}return"interface conversion: "+a.concreteString+" is not "+a.assertedString+": missing method "+a.missingMethod;};W.prototype.Error=function(){return this.$val.Error();};Y.prototype.RuntimeError=function(){var $ptr,a;a=this.$val;};$ptrType(Y).prototype.RuntimeError=function(){return new Y(this.$get()).RuntimeError();};Y.prototype.Error=function(){var $ptr,a;a=this.$val;return"runtime error: "+a;};$ptrType(Y).prototype.Error=function(){return new Y(this.$get()).Error();};AQ.methods=[{prop:"RuntimeError",name:"RuntimeError",pkg:"",typ:$funcType([],[],false)},{prop:"Error",name:"Error",pkg:"",typ:$funcType([],[$String],false)}];Y.methods=[{prop:"RuntimeError",name:"RuntimeError",pkg:"",typ:$funcType([],[],false)},{prop:"Error",name:"Error",pkg:"",typ:$funcType([],[$String],false)}];W.init([{prop:"interfaceString",name:"interfaceString",pkg:"runtime",typ:$String,tag:""},{prop:"concreteString",name:"concreteString",pkg:"runtime",typ:$String,tag:""},{prop:"assertedString",name:"assertedString",pkg:"runtime",typ:$String,tag:""},{prop:"missingMethod",name:"missingMethod",pkg:"runtime",typ:$String,tag:""}]);$init=function(){$pkg.$init=function(){};var $f,$c=false,$s=0,$r;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=A.$init();$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}C();}return;}if($f===undefined){$f={$blk:$init};}$f.$s=$s;$f.$r=$r;return $f;};$pkg.$init=$init;return $pkg;})();
$packages["errors"]=(function(){var $pkg={},$init,B,C,A;B=$pkg.errorString=$newType(0,$kindStruct,"errors.errorString","errorString","errors",function(s_){this.$val=this;if(arguments.length===0){this.s="";return;}this.s=s_;});C=$ptrType(B);A=function(a){var $ptr,a;return new B.ptr(a);};$pkg.New=A;B.ptr.prototype.Error=function(){var $ptr,a;a=this;return a.s;};B.prototype.Error=function(){return this.$val.Error();};C.methods=[{prop:"Error",name:"Error",pkg:"",typ:$funcType([],[$String],false)}];B.init([{prop:"s",name:"s",pkg:"errors",typ:$String,tag:""}]);$init=function(){$pkg.$init=function(){};var $f,$c=false,$s=0,$r;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:}return;}if($f===undefined){$f={$blk:$init};}$f.$s=$s;$f.$r=$r;return $f;};$pkg.$init=$init;return $pkg;})();
$packages["sort"]=(function(){var $pkg={},$init,A;A=function(a,b){var $ptr,a,b,c,d,e,f,g,h,i,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:c=0;d=a;e=c;f=d;case 1:if(!(e<f)){$s=2;continue;}h=e+(g=((f-e>>0))/2,(g===g&&g!==1/0&&g!==-1/0)?g>>0:$throwRuntimeError("integer divide by zero"))>>0;i=b(h);$s=6;case 6:if($c){$c=false;i=i.$blk();}if(i&&i.$blk!==undefined){break s;}if(!i){$s=3;continue;}$s=4;continue;case 3:e=h+1>>0;$s=5;continue;case 4:f=h;case 5:$s=1;continue;case 2:return e;$s=-1;case-1:}return;}if($f===undefined){$f={$blk:A};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.$s=$s;$f.$r=$r;return $f;};$pkg.Search=A;$init=function(){$pkg.$init=function(){};var $f,$c=false,$s=0,$r;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:}return;}if($f===undefined){$f={$blk:$init};}$f.$s=$s;$f.$r=$r;return $f;};$pkg.$init=$init;return $pkg;})();
$packages["ninchatclient"]=(function(){var $pkg={},$init,A,B,C,D,L,AL,AO,AP,AR,AS,AU,AX,BJ,BK,BL,BM,BN,BO,BP,BQ,BR,BS,BT,BU,BV,BW,BX,BY,BZ,CA,CB,CC,CD,CE,CF,CG,CH,CI,CJ,AJ,AN,BE,BF,E,F,G,H,I,J,K,M,N,O,P,Q,R,S,T,U,V,W,X,Z,AA,AB,AC,AD,AE,AF,AG,AH,AI,AK,AM,AQ,AT,AV,AW,AY,AZ,BA,BB,BC,BD,BG,BH,BI;A=$packages["errors"];B=$packages["github.com/gopherjs/gopherjs/js"];C=$packages["sort"];D=$pkg.Action=$newType(0,$kindStruct,"main.Action","Action","ninchatclient",function(Id_,Header_,Payload_,Deferred_,name_){this.$val=this;if(arguments.length===0){this.Id=new $Uint64(0,0);this.Header=null;this.Payload=null;this.Deferred=BU.nil;this.name="";return;}this.Id=Id_;this.Header=Header_;this.Payload=Payload_;this.Deferred=Deferred_;this.name=name_;});L=$pkg.Backoff=$newType(0,$kindStruct,"main.Backoff","Backoff","ninchatclient",function(lastSlot_){this.$val=this;if(arguments.length===0){this.lastSlot=0;return;}this.lastSlot=lastSlot_;});AL=$pkg.Deferred=$newType(0,$kindStruct,"main.Deferred","Deferred","ninchatclient",function(resolve_,reject_,notify_){this.$val=this;if(arguments.length===0){this.resolve=BV.nil;this.reject=BV.nil;this.notify=BV.nil;return;}this.resolve=resolve_;this.reject=reject_;this.notify=notify_;});AO=$pkg.Transport=$newType(4,$kindFunc,"main.Transport","Transport","ninchatclient",null);AP=$pkg.Session=$newType(0,$kindStruct,"main.Session","Session","ninchatclient",function(onSessionEvent_,onEvent_,onConnState_,onConnActive_,onLog_,address_,forceLongPoll_,sessionParams_,sessionId_,latestConnState_,latestConnActive_,lastActionId_,sendNotify_,sendBuffer_,numSent_,sendEventAck_,receivedEventId_,ackedEventId_,closeNotify_,closed_,stopped_){this.$val=this;if(arguments.length===0){this.onSessionEvent=null;this.onEvent=null;this.onConnState=null;this.onConnActive=null;this.onLog=null;this.address="";this.forceLongPoll=false;this.sessionParams=false;this.sessionId=null;this.latestConnState="";this.latestConnActive=new AR(0,0);this.lastActionId=new $Uint64(0,0);this.sendNotify=BX.nil;this.sendBuffer=BZ.nil;this.numSent=0;this.sendEventAck=false;this.receivedEventId=new $Uint64(0,0);this.ackedEventId=new $Uint64(0,0);this.closeNotify=BX.nil;this.closed=false;this.stopped=false;return;}this.onSessionEvent=onSessionEvent_;this.onEvent=onEvent_;this.onConnState=onConnState_;this.onConnActive=onConnActive_;this.onLog=onLog_;this.address=address_;this.forceLongPoll=forceLongPoll_;this.sessionParams=sessionParams_;this.sessionId=sessionId_;this.latestConnState=latestConnState_;this.latestConnActive=latestConnActive_;this.lastActionId=lastActionId_;this.sendNotify=sendNotify_;this.sendBuffer=sendBuffer_;this.numSent=numSent_;this.sendEventAck=sendEventAck_;this.receivedEventId=receivedEventId_;this.ackedEventId=ackedEventId_;this.closeNotify=closeNotify_;this.closed=closed_;this.stopped=stopped_;});AR=$pkg.Time=$newType(8,$kindInt64,"main.Time","Time","ninchatclient",null);AS=$pkg.Duration=$newType(8,$kindInt64,"main.Duration","Duration","ninchatclient",null);AU=$pkg.Timer=$newType(0,$kindStruct,"main.Timer","Timer","ninchatclient",function(C_,id_){this.$val=this;if(arguments.length===0){this.C=BX.nil;this.id=null;return;}this.C=C_;this.id=id_;});AX=$pkg.WebSocket=$newType(0,$kindStruct,"main.WebSocket","WebSocket","ninchatclient",function(Notify_,GoingAway_,impl_,open_,error_,buffer_){this.$val=this;if(arguments.length===0){this.Notify=BX.nil;this.GoingAway=false;this.impl=null;this.open=false;this.error=$ifaceNil;this.buffer=BV.nil;return;}this.Notify=Notify_;this.GoingAway=GoingAway_;this.impl=impl_;this.open=open_;this.error=error_;this.buffer=buffer_;});BJ=$sliceType($String);BK=$mapType($String,$emptyInterface);BL=$sliceType($emptyInterface);BM=$ptrType(B.Error);BN=$funcType([],[],false);BO=$ptrType($Bool);BP=$chanType($String,false,true);BQ=$ptrType(B.Object);BR=$funcType([BQ,BQ,BQ],[$emptyInterface],false);BS=$funcType([],[BK],false);BT=$funcType([BQ],[$String],false);BU=$ptrType(AL);BV=$sliceType(BQ);BW=$funcType([BQ,BQ,BQ],[],false);BX=$chanType($Bool,false,false);BY=$ptrType(D);BZ=$sliceType(BY);CA=$funcType([BQ],[],false);CB=$mapType($String,BQ);CC=$funcType([CB],[],false);CD=$funcType([BQ,BQ],[$emptyInterface],false);CE=$ptrType(AU);CF=$ptrType(AX);CG=$sliceType($Uint8);CH=$chanType($String,false,false);CI=$ptrType(L);CJ=$ptrType(AP);D.ptr.prototype.Name=function(){var $ptr,a;a=this;if(a.name===""){a.name=$internalize(a.Header.action,$String);}return a.name;};D.prototype.Name=function(){return this.$val.Name();};E=function(a){var $ptr,a;if(a===undefined||a===null){return"api.ninchat.com";}else{return $internalize(a,$String);}};$pkg.GetAddress=E;F=function(a){var $ptr,a,b,c,d,e,f,g,$deferred;var $err=null;try{$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);b=BJ.nil;c=$ifaceNil;$deferred.push([(function(){var $ptr,d;d=Q($recover());if(!($interfaceIsEqual(d,$ifaceNil))){c=d;}}),[]]);d=Z(a);e=d[0];c=d[1];if(!($interfaceIsEqual(c,$ifaceNil))){return[b,c];}f=e.hosts;if($parseInt(f.length)===0){c=A.New("endpoint hosts array is empty");return[b,c];}b=$makeSlice(BJ,$parseInt(f.length));g=0;while(true){if(!(g<$parseInt(f.length))){break;}((g<0||g>=b.$length)?$throwRuntimeError("index out of range"):b.$array[b.$offset+g]=$internalize(f[g],$String));g=g+(1)>>0;}return[b,c];}catch(err){$err=err;}finally{$callDeferred($deferred,$err);if(!$curGoroutine.asleep){return[b,c];}}};$pkg.GetEndpointHosts=F;G=function(a){var $ptr,a,b,c,d,e,f,g,h,$deferred;var $err=null;try{$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);b=null;c=null;d=null;e=new $Uint64(0,0);f=false;g=$ifaceNil;$deferred.push([(function(){var $ptr,h;h=Q($recover());if(!($interfaceIsEqual(h,$ifaceNil))){g=h;}}),[]]);if(!($internalize(a.event,$String)==="session_created")){return[b,c,d,e,f,g];}b=a.user_id;h=a.user_auth;if(!(h===undefined)){c=h;}d=a.session_id;e=$internalize(a.event_id,$Uint64);f=true;return[b,c,d,e,f,g];}catch(err){$err=err;}finally{$callDeferred($deferred,$err);if(!$curGoroutine.asleep){return[b,c,d,e,f,g];}}};$pkg.GetSessionEventCredentials=G;H=function(a){var $ptr,a,b,c,d,$deferred;var $err=null;try{$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);b=0;c=$ifaceNil;$deferred.push([(function(){var $ptr;c=Q($recover());}),[]]);d=a.frames;if(!(d===undefined)){b=$parseInt(d)>>0;if(b<0){b=0;}}return[b,c];}catch(err){$err=err;}finally{$callDeferred($deferred,$err);if(!$curGoroutine.asleep){return[b,c];}}};$pkg.GetEventFrames=H;I=function(a){var $ptr,a,b,c,d,e,f,$deferred;var $err=null;try{$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);b=new $Uint64(0,0);c=new $Uint64(0,0);d=$ifaceNil;$deferred.push([(function(){var $ptr;d=Q($recover());}),[]]);e=a.event_id;if(!(e===undefined)){b=$internalize(e,$Uint64);}f=a.action_id;if(!(f===undefined)){c=$internalize(f,$Uint64);}return[b,c,d];}catch(err){$err=err;}finally{$callDeferred($deferred,$err);if(!$curGoroutine.asleep){return[b,c,d];}}};$pkg.GetEventAndActionId=I;J=function(a,b){var $ptr,a,b,c,d,e,f,g,$deferred;var $err=null;try{$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);c=false;d=$ifaceNil;$deferred.push([(function(){var $ptr;d=Q($recover());}),[]]);c=true;e=a.history_length;if(!(e===undefined)){if(($parseInt(e)>>0)>0){c=false;}}if(b.Name()==="search"){f=a.users;g=a.channels;if(!(f===undefined)||!(g===undefined)){c=false;}}return[c,d];}catch(err){$err=err;}finally{$callDeferred($deferred,$err);if(!$curGoroutine.asleep){return[c,d];}}};$pkg.IsEventLastReply=J;K=function(a){var $ptr,a,b,c,d,e,f,g,$deferred;var $err=null;try{$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);b="";c="";d=false;e=$ifaceNil;$deferred.push([(function(){var $ptr,f;f=Q($recover());if(!($interfaceIsEqual(f,$ifaceNil))){e=f;}}),[]]);if(!($internalize(a.event,$String)==="error")){return[b,c,d,e];}b=$internalize(a.error_type,$String);f=a.error_reason;if(!(f===undefined)){c=$internalize(f,$String);}g=b;if(g==="session_not_found"){d=true;if(!(c==="")){e=A.New("error: "+b+" ("+c+")");}else{e=A.New("error: "+b);}}else if(g==="connection_superseded"||g==="message_has_too_many_parts"||g==="message_part_too_long"||g==="message_too_long"||g==="request_malformed"){if(!(c==="")){e=A.New("error: "+b+" ("+c+")");}else{e=A.New("error: "+b);}}return[b,c,d,e];}catch(err){$err=err;}finally{$callDeferred($deferred,$err);if(!$curGoroutine.asleep){return[b,c,d,e];}}};$pkg.GetEventError=K;L.ptr.prototype.Success=function(){var $ptr,a;a=this;a.lastSlot=0;};L.prototype.Success=function(){return this.$val.Success();};L.ptr.prototype.Failure=function(a){var $ptr,a,b,c;b=new AS(0,0);c=this;if(c.lastSlot>0){b=new AS(0,N($flatten64(a)*c.lastSlot/1024,-0.5));}if(c.lastSlot<1023){c.lastSlot=((((c.lastSlot+1>>0))<<1>>0))-1>>0;}return b;};L.prototype.Failure=function(a){return this.$val.Failure(a);};M=function(a,b,c){var $ptr,a,b,c,d,e,f,g;d=$ifaceNil;e="https://"+E(c)+"/v2/call";f=AM();g=f[0];d=new BK(f[1]);$go((function $b(){var $ptr,h,i,j,k,l,m,n,o,p,q,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;q=$f.q;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:h=BI(e,new $jsObjectPtr(a),O(new AS(0,11000),0.1));i=h[0];j=h[1];if(!($interfaceIsEqual(j,$ifaceNil))){$s=1;continue;}$s=2;continue;case 1:$r=AE("NinchatClient.call onLog callback",b,new BL([new $String("call:"),j]));$s=3;case 3:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=g.Reject(new BL([]));$s=4;case 4:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return;case 2:l=$recv(i);$s=5;case 5:if($c){$c=false;l=l.$blk();}if(l&&l.$blk!==undefined){break s;}k=l;m=k[0];n=k[1];if(m===""){$s=6;continue;}$s=7;continue;case 6:if(n){$s=8;continue;}$s=9;continue;case 8:$r=AE("NinchatClient.call onLog callback",b,new BL([new $String("call error")]));$s=11;case 11:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=10;continue;case 9:$r=AE("NinchatClient.call onLog callback",b,new BL([new $String("call timeout")]));$s=12;case 12:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 10:$r=g.Reject(new BL([]));$s=13;case 13:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return;case 7:o=Z(m);p=o[0];j=o[1];if(!($interfaceIsEqual(j,$ifaceNil))){$s=14;continue;}$s=15;continue;case 14:$r=AE("NinchatClient.call onLog callback",b,new BL([new $String("call response:"),j]));$s=16;case 16:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=g.Reject(new BL([]));$s=17;case 17:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return;case 15:q=U();q.push(p);$r=g.Resolve(new BL([new $jsObjectPtr(q)]));$s=18;case 18:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.q=q;$f.$s=$s;$f.$r=$r;return $f;}),[]);return d;};$pkg.Call=M;N=function(a,b){var $ptr,a,b;return a+a*b*AB();};$pkg.Jitter=N;O=function(a,b){var $ptr,a,b;return new AS(0,N($flatten64(a),b));};$pkg.JitterDuration=O;P=function(a,b){var $ptr,a,b;return new $Uint64(0,N($flatten64(a),b));};$pkg.JitterUint64=P;Q=function(a){var $ptr,a,b,c,d,e,f;b=$ifaceNil;if($interfaceIsEqual(a,$ifaceNil)){return b;}c=$assertType(a,BM,true);d=c[0];e=c[1];if(e){f=$internalize(d.Object.message,$String);if(f===""){f="error";}b=A.New(f);return b;}b=$assertType(a,$error);return b;};R=function(a,b,c){var $ptr,a,b,c,d,$s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);a=[a];d=false;$deferred.push([(function(a){return function $b(){var $ptr,e,f,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;e=$f.e;f=$f.f;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:e=Q($recover());if(!($interfaceIsEqual(e,$ifaceNil))){$s=1;continue;}$s=2;continue;case 1:f=e.Error();$s=3;case 3:if($c){$c=false;f=f.$blk();}if(f&&f.$blk!==undefined){break s;}console.log(a[0]+" invocation error: "+f);case 2:$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.e=e;$f.f=f;$f.$s=$s;$f.$r=$r;return $f;};})(a),[]]);b.apply(undefined,$externalize(c,BL));d=true;return d;$s=-1;case-1:}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if(!$curGoroutine.asleep){return d;}if($curGoroutine.asleep){if($f===undefined){$f={$blk:R};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}};S=function(a){var $ptr,a,b,c,$deferred;var $err=null;try{$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);b=null;c=$ifaceNil;$deferred.push([(function(){var $ptr;c=Q($recover());}),[]]);b=$global.atob(a);return[b,c];}catch(err){$err=err;}finally{$callDeferred($deferred,$err);if(!$curGoroutine.asleep){return[b,c];}}};$pkg.Atob=S;T=function(a){var $ptr,a,b,c,$deferred;var $err=null;try{$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);b=null;c=$ifaceNil;$deferred.push([(function(){var $ptr;c=Q($recover());}),[]]);b=a.split($externalize(",",$String))[1];return[b,c];}catch(err){$err=err;}finally{$callDeferred($deferred,$err);if(!$curGoroutine.asleep){return[b,c];}}};$pkg.ParseDataURI=T;U=function(){var $ptr;return new($global.Array)();};$pkg.NewArray=U;V=function(a){var $ptr,a;return new($global.ArrayBuffer)(a);};$pkg.NewArrayBuffer=V;W=function(a){var $ptr,a;return new($global.Uint8Array)(a);};$pkg.NewUint8Array=W;X=function(){var $ptr;return new($global.Object)();};$pkg.NewObject=X;Z=function(a){var $ptr,a,b,c,$deferred;var $err=null;try{$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);b=null;c=$ifaceNil;$deferred.push([(function(){var $ptr;c=Q($recover());}),[]]);b=$global.JSON.parse($externalize(a,$String));return[b,c];}catch(err){$err=err;}finally{$callDeferred($deferred,$err);if(!$curGoroutine.asleep){return[b,c];}}};$pkg.ParseJSON=Z;AA=function(a){var $ptr,a,b,c,$deferred;var $err=null;try{$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);b="";c=$ifaceNil;$deferred.push([(function(){var $ptr;c=Q($recover());}),[]]);b=$internalize($global.JSON.stringify($externalize(a,$emptyInterface)),$String);return[b,c];}catch(err){$err=err;}finally{$callDeferred($deferred,$err);if(!$curGoroutine.asleep){return[b,c];}}};$pkg.StringifyJSON=AA;AB=function(){var $ptr;return $parseFloat($global.Math.random());};$pkg.Random=AB;AC=function(a,b){var $ptr,a,b,c;c=null;c=$global.setTimeout($externalize(a,BN),$externalize(b,AS));return c;};$pkg.SetTimeout=AC;AD=function(a){var $ptr,a;$global.clearTimeout(a);};$pkg.ClearTimeout=AD;AE=function(a,b,c){var $ptr,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:if(b===undefined||b===null){return;}d="";e=c;f=0;case 1:if(!(f<e.$length)){$s=2;continue;}g=((f<0||f>=e.$length)?$throwRuntimeError("index out of range"):e.$array[e.$offset+f]);h="?";i=$assertType(g,$String,true);j=i[0];k=i[1];if(k){$s=3;continue;}$s=4;continue;case 3:h=j;$s=5;continue;case 4:l=$assertType(g,$error,true);m=l[0];n=l[1];if(n){$s=6;continue;}$s=7;continue;case 6:o=m.Error();$s=8;case 8:if($c){$c=false;o=o.$blk();}if(o&&o.$blk!==undefined){break s;}h=o;case 7:case 5:if(d.length>0){d=d+(" ");}d=d+(h);f++;$s=1;continue;case 2:while(true){if(!(d.length>0&&(d.charCodeAt((d.length-1>>0))===32))){break;}d=d.substring(0,(d.length-1>>0));}p=R(a,b,new BL([new $String(d)]));$s=9;case 9:if($c){$c=false;p=p.$blk();}if(p&&p.$blk!==undefined){break s;}p;$s=-1;case-1:}return;}if($f===undefined){$f={$blk:AE};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.$s=$s;$f.$r=$r;return $f;};$pkg.Log=AE;AF=function(a,b){var $ptr,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,$s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;q=$f.q;r=$f.r;s=$f.s;t=$f.t;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);a=[a];c=[c];d=[d];d[0]=false;c[0]=false;$deferred.push([(function(a,c,d){return function $b(){var $ptr,e,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;e=$f.e;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:e=Q($recover());if(!($interfaceIsEqual(e,$ifaceNil))){$s=1;continue;}$s=2;continue;case 1:$r=a[0].log(new BL([new $String("poll:"),e]));$s=3;case 3:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 2:$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.e=e;$f.$s=$s;$f.$r=$r;return $f;};})(a,c,d),[]]);e="https://"+b+"/v2/poll";if(a[0].sessionId===null){$s=1;continue;}$s=2;continue;case 1:$r=a[0].log(new BL([new $String("session creation")]));$s=4;case 4:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}f=a[0].makeCreateSessionAction();g=BI(e,new $jsObjectPtr(f),O(new AS(0,13000),0.2));h=g[0];i=g[1];if(!($interfaceIsEqual(i,$ifaceNil))){$s=5;continue;}$s=6;continue;case 5:$r=a[0].log(new BL([new $String("session creation:"),i]));$s=7;case 7:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return[d[0],c[0]];case 6:k=$select([[h],[a[0].closeNotify]]);$s=8;case 8:if($c){$c=false;k=k.$blk();}if(k&&k.$blk!==undefined){break s;}j=k;if(j[0]===0){$s=9;continue;}if(j[0]===1){$s=10;continue;}$s=11;continue;case 9:l=j[1];m=l[0];n=l[1];if(!n){$s=12;continue;}if(m===""){$s=13;continue;}$s=14;continue;case 12:$r=a[0].log(new BL([new $String("session creation timeout")]));$s=15;case 15:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return[d[0],c[0]];$s=14;continue;case 13:$r=a[0].log(new BL([new $String("session creation error")]));$s=16;case 16:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return[d[0],c[0]];case 14:o=Z(m);p=o[0];q=o[1];if(!($interfaceIsEqual(q,$ifaceNil))){$s=17;continue;}$s=18;continue;case 17:$r=a[0].log(new BL([new $String("session creation response:"),q]));$s=19;case 19:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return[d[0],c[0]];case 18:r=p[0];s=a[0].handleSessionEvent(r);$s=22;case 22:if($c){$c=false;s=s.$blk();}if(s&&s.$blk!==undefined){break s;}if(!s){$s=20;continue;}$s=21;continue;case 20:return[d[0],c[0]];case 21:$s=11;continue;case 10:$r=AI(a[0],e);$s=23;case 23:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return[d[0],c[0]];case 11:d[0]=true;c[0]=true;$r=a[0].connState("connected");$s=24;case 24:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=a[0].connActive();$s=25;case 25:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=3;continue;case 2:$r=a[0].log(new BL([new $String("session resumption")]));$s=26;case 26:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}t=AH(a[0],e);if(!($interfaceIsEqual(t,$ifaceNil))){$s=27;continue;}$s=28;continue;case 27:$r=a[0].log(new BL([new $String("session resumption:"),t]));$s=29;case 29:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return[d[0],c[0]];case 28:case 3:$r=AG(a[0],e,(d.$ptr||(d.$ptr=new BO(function(){return this.$target[0];},function($v){this.$target[0]=$v;},d))),(c.$ptr||(c.$ptr=new BO(function(){return this.$target[0];},function($v){this.$target[0]=$v;},c))));$s=30;case 30:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return[d[0],c[0]];$s=-1;case-1:}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if(!$curGoroutine.asleep){return[d[0],c[0]];}if($curGoroutine.asleep){if($f===undefined){$f={$blk:AF};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.q=q;$f.r=r;$f.s=s;$f.t=t;$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}};$pkg.LongPollTransport=AF;AG=function(a,b,c,d){var $ptr,a,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,as,at,au,av,aw,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;aa=$f.aa;ab=$f.ab;ac=$f.ac;ad=$f.ad;ae=$f.ae;af=$f.af;ag=$f.ag;ah=$f.ah;ai=$f.ai;aj=$f.aj;ak=$f.ak;al=$f.al;am=$f.am;an=$f.an;ao=$f.ao;ap=$f.ap;aq=$f.aq;ar=$f.ar;as=$f.as;at=$f.at;au=$f.au;av=$f.av;aw=$f.aw;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;q=$f.q;r=$f.r;s=$f.s;t=$f.t;u=$f.u;v=$f.v;w=$f.w;x=$f.x;y=$f.y;z=$f.z;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:e=BP.nil;f=BP.nil;g=new $Uint64(0,0);h=0;a.numSent=0;case 1:if(!(h<2)){$s=2;continue;}if(e===BP.nil){$s=3;continue;}$s=4;continue;case 3:i=$ifaceNil;j=a.makeResumeSessionAction(true);k=BI(b,new $jsObjectPtr(j),O(new AS(0,64000),0.2));e=k[0];i=k[1];if(!($interfaceIsEqual(i,$ifaceNil))){$s=5;continue;}$s=6;continue;case 5:$r=a.log(new BL([new $String("poll:"),i]));$s=7;case 7:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return;case 6:case 4:if(f===BP.nil&&a.numSent<a.sendBuffer.$length){$s=8;continue;}$s=9;continue;case 8:n=(l=a.sendBuffer,m=a.numSent,((m<0||m>=l.$length)?$throwRuntimeError("index out of range"):l.$array[l.$offset+m]));if(!(n.Payload===null)){$s=10;continue;}$s=11;continue;case 10:o=null;p=$ifaceNil;q=n.Payload[0];if($internalize(n.Header.action,$String)==="update_user"){$s=12;continue;}$s=13;continue;case 12:r=T(q);s=r[0];t=r[1];if(!($interfaceIsEqual(t,$ifaceNil))){$s=15;continue;}$s=16;continue;case 15:$r=a.log(new BL([new $String("send:"),t]));$s=17;case 17:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return;case 16:o=U();o.push(s);$s=14;continue;case 13:u=Z($internalize(q,$String));o=u[0];p=u[1];if(!($interfaceIsEqual(p,$ifaceNil))){$s=18;continue;}$s=19;continue;case 18:$r=a.log(new BL([new $String("send:"),p]));$s=20;case 20:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return;case 19:case 14:n.Header.payload=o;case 11:n.Header.session_id=a.sessionId;v=AA(new $jsObjectPtr(n.Header));w=v[0];x=v[1];delete n.Header[$externalize("session_id",$String)];delete n.Header[$externalize("payload",$String)];if(!($interfaceIsEqual(x,$ifaceNil))){$s=21;continue;}$s=22;continue;case 21:$r=a.log(new BL([new $String("send:"),x]));$s=23;case 23:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return;case 22:y=BH(b,w,O(new AS(0,7000),0.2));z=y[0];x=y[1];if(!($interfaceIsEqual(x,$ifaceNil))){$s=24;continue;}$s=25;continue;case 24:$r=a.log(new BL([new $String("send:"),x]));$s=26;case 26:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return;case 25:if((aa=n.Id,(aa.$high===0&&aa.$low===0))){a.sendBuffer=$appendSlice($subslice(a.sendBuffer,0,a.numSent),$subslice(a.sendBuffer,(a.numSent+1>>0)));}else{f=z;g=n.Id;}case 9:ab="";ac=false;ae=$select([[e],[f],[a.sendNotify],[a.closeNotify]]);$s=27;case 27:if($c){$c=false;ae=ae.$blk();}if(ae&&ae.$blk!==undefined){break s;}ad=ae;if(ad[0]===0){$s=28;continue;}if(ad[0]===1){$s=29;continue;}if(ad[0]===2){$s=30;continue;}if(ad[0]===3){$s=31;continue;}$s=32;continue;case 28:af=ad[1];ab=af[0];ac=af[1];if(!ac){$s=33;continue;}if(ab===""){$s=34;continue;}$s=35;continue;case 33:$r=a.log(new BL([new $String("poll timeout")]));$s=36;case 36:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=35;continue;case 34:$r=a.log(new BL([new $String("poll error")]));$s=37;case 37:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 35:e=BP.nil;$r=a.connActive();$s=38;case 38:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=32;continue;case 29:ag=ad[1];ab=ag[0];ac=ag[1];if(!ac){$s=39;continue;}if(ab===""){$s=40;continue;}if((g.$high>0||(g.$high===0&&g.$low>0))){$s=41;continue;}$s=42;continue;case 39:$r=a.log(new BL([new $String("send timeout")]));$s=43;case 43:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=42;continue;case 40:$r=a.log(new BL([new $String("send error")]));$s=44;case 44:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=42;continue;case 41:a.numSent=a.numSent+(1)>>0;case 42:f=BP.nil;g=new $Uint64(0,0);$s=32;continue;case 30:ah=ad[1][0];if(!ah){$s=45;continue;}$s=46;continue;case 45:$r=AI(a,b);$s=47;case 47:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return;case 46:$s=1;continue;$s=32;continue;case 31:$r=AI(a,b);$s=48;case 48:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return;case 32:ai=null;if(!(ab==="")){$s=49;continue;}$s=50;continue;case 49:aj=$ifaceNil;ak=Z(ab);ai=ak[0];aj=ak[1];if(!($interfaceIsEqual(aj,$ifaceNil))){$s=51;continue;}$s=52;continue;case 51:$r=a.log(new BL([new $String("response:"),aj]));$s=53;case 53:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 52:case 50:if(ai===null){$s=54;continue;}$s=55;continue;case 54:h=h+(1)>>0;a.numSent=0;$s=1;continue;case 55:h=0;c.$set(true);al=0;case 56:if(!(al<$parseInt(ai.length))){$s=57;continue;}am=ai[al];an=U();ao=am.payload;if(!(ao===undefined)){$s=58;continue;}$s=59;continue;case 58:ap=AA(new $jsObjectPtr(ao));aq=ap[0];ar=ap[1];if(!($interfaceIsEqual(ar,$ifaceNil))){$s=60;continue;}$s=61;continue;case 60:$r=a.log(new BL([new $String("poll payload:"),ar]));$s=62;case 62:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return;case 61:an.push($externalize(aq,$String));case 59:at=a.handleEvent(am,an);$s=63;case 63:if($c){$c=false;at=at.$blk();}if(at&&at.$blk!==undefined){break s;}as=at;au=as[0];av=as[1];aw=as[3];if((g.$high>0||(g.$high===0&&g.$low>0))&&(g.$high<au.$high||(g.$high===au.$high&&g.$low<=au.$low))){g=new $Uint64(0,0);a.numSent=a.numSent+(1)>>0;}if(!aw){if(av){d.$set(true);}return;}if(!d.$get()){$s=64;continue;}$s=65;continue;case 64:d.$set(true);$r=a.connState("connected");$s=66;case 66:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 65:al=al+(1)>>0;$s=56;continue;case 57:$s=1;continue;case 2:return;$s=-1;case-1:}return;}if($f===undefined){$f={$blk:AG};}$f.$ptr=$ptr;$f.a=a;$f.aa=aa;$f.ab=ab;$f.ac=ac;$f.ad=ad;$f.ae=ae;$f.af=af;$f.ag=ag;$f.ah=ah;$f.ai=ai;$f.aj=aj;$f.ak=ak;$f.al=al;$f.am=am;$f.an=an;$f.ao=ao;$f.ap=ap;$f.aq=aq;$f.ar=ar;$f.as=as;$f.at=at;$f.au=au;$f.av=av;$f.aw=aw;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.q=q;$f.r=r;$f.s=s;$f.t=t;$f.u=u;$f.v=v;$f.w=w;$f.x=x;$f.y=y;$f.z=z;$f.$s=$s;$f.$r=$r;return $f;};AH=function(a,b){var $ptr,a,b,c,d,e,f,g;c=$ifaceNil;d=(e=new $Map(),f="action",e[f]={k:f,v:new $String("ping")},f="session_id",e[f]={k:f,v:new $jsObjectPtr(a.sessionId)},e);g=BI(b,new BK(d),O(new AS(0,7000),0.9));c=g[1];return c;};AI=function(a,b){var $ptr,a,b,c,d,e,f,g,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:c=(d=new $Map(),e="action",d[e]={k:e,v:new $String("close_session")},e="session_id",d[e]={k:e,v:new $jsObjectPtr(a.sessionId)},d);f=BI(b,new BK(c),O(new AS(0,7000),0.9));g=f[1];if(!($interfaceIsEqual(g,$ifaceNil))){$s=1;continue;}$s=2;continue;case 1:$r=a.log(new BL([new $String("send:"),g]));$s=3;case 3:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 2:$s=-1;case-1:}return;}if($f===undefined){$f={$blk:AI};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.$s=$s;$f.$r=$r;return $f;};AK=function(){var $ptr;AJ.call=$externalize(M,BR);AJ.newSession=$externalize(AQ,BS);AJ.stringifyFrame=$externalize(AZ,BT);$global.NinchatClient=AJ;};AM=function(){var $ptr,a,b,c,d;a=BU.nil;b=false;a=new AL.ptr(BV.nil,BV.nil,BV.nil);b=(c=new $Map(),d="then",c[d]={k:d,v:new BW($methodVal(a,"then"))},c);return[a,b];};$pkg.Defer=AM;AL.ptr.prototype.then=function(a,b,c){var $ptr,a,b,c,d;d=this;if(!(a===undefined)&&!(a===null)){d.resolve=$append(d.resolve,a);}if(!(b===undefined)&&!(b===null)){d.reject=$append(d.reject,b);}if(!(c===undefined)&&!(c===null)){d.notify=$append(d.notify,c);}};AL.prototype.then=function(a,b,c){return this.$val.then(a,b,c);};AL.ptr.prototype.Resolve=function(a){var $ptr,a,b,c,d,e,f,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:b=this;c=b.resolve;d=0;case 1:if(!(d<c.$length)){$s=2;continue;}e=((d<0||d>=c.$length)?$throwRuntimeError("index out of range"):c.$array[c.$offset+d]);f=R("NinchatClient promise resolve callback",e,a);$s=3;case 3:if($c){$c=false;f=f.$blk();}if(f&&f.$blk!==undefined){break s;}f;d++;$s=1;continue;case 2:$s=-1;case-1:}return;}if($f===undefined){$f={$blk:AL.ptr.prototype.Resolve};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.$s=$s;$f.$r=$r;return $f;};AL.prototype.Resolve=function(a){return this.$val.Resolve(a);};AL.ptr.prototype.Reject=function(a){var $ptr,a,b,c,d,e,f,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:b=this;c=b.reject;d=0;case 1:if(!(d<c.$length)){$s=2;continue;}e=((d<0||d>=c.$length)?$throwRuntimeError("index out of range"):c.$array[c.$offset+d]);f=R("NinchatClient promise reject callback",e,a);$s=3;case 3:if($c){$c=false;f=f.$blk();}if(f&&f.$blk!==undefined){break s;}f;d++;$s=1;continue;case 2:$s=-1;case-1:}return;}if($f===undefined){$f={$blk:AL.ptr.prototype.Reject};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.$s=$s;$f.$r=$r;return $f;};AL.prototype.Reject=function(a){return this.$val.Reject(a);};AL.ptr.prototype.Notify=function(a){var $ptr,a,b,c,d,e,f,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:b=this;c=b.notify;d=0;case 1:if(!(d<c.$length)){$s=2;continue;}e=((d<0||d>=c.$length)?$throwRuntimeError("index out of range"):c.$array[c.$offset+d]);f=R("NinchatClient promise notify callback",e,a);$s=3;case 3:if($c){$c=false;f=f.$blk();}if(f&&f.$blk!==undefined){break s;}f;d++;$s=1;continue;case 2:$s=-1;case-1:}return;}if($f===undefined){$f={$blk:AL.ptr.prototype.Notify};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.$s=$s;$f.$r=$r;return $f;};AL.prototype.Notify=function(a){return this.$val.Notify(a);};AQ=function(){var $ptr,a,b,c;a=new AP.ptr(null,null,null,null,null,"api.ninchat.com",false,false,null,"",new AR(0,0),new $Uint64(0,0),BX.nil,BZ.nil,0,false,new $Uint64(0,0),new $Uint64(0,0),BX.nil,false,true);return(b=new $Map(),c="onSessionEvent",b[c]={k:c,v:new CA($methodVal(a,"OnSessionEvent"))},c="onEvent",b[c]={k:c,v:new CA($methodVal(a,"OnEvent"))},c="onConnState",b[c]={k:c,v:new CA($methodVal(a,"OnConnState"))},c="onConnActive",b[c]={k:c,v:new CA($methodVal(a,"OnConnActive"))},c="onLog",b[c]={k:c,v:new CA($methodVal(a,"OnLog"))},c="setParams",b[c]={k:c,v:new CC($methodVal(a,"SetParams"))},c="setTransport",b[c]={k:c,v:new CA($methodVal(a,"SetTransport"))},c="setAddress",b[c]={k:c,v:new CA($methodVal(a,"SetAddress"))},c="open",b[c]={k:c,v:new BN($methodVal(a,"Open"))},c="close",b[c]={k:c,v:new BN($methodVal(a,"Close"))},c="send",b[c]={k:c,v:new CD($methodVal(a,"Send"))},b);};$pkg.NewSession=AQ;AP.ptr.prototype.OnSessionEvent=function(a){var $ptr,a,b;b=this;b.onSessionEvent=a;};AP.prototype.OnSessionEvent=function(a){return this.$val.OnSessionEvent(a);};AP.ptr.prototype.OnEvent=function(a){var $ptr,a,b;b=this;b.onEvent=a;};AP.prototype.OnEvent=function(a){return this.$val.OnEvent(a);};AP.ptr.prototype.OnConnState=function(a){var $ptr,a,b,c,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:b=this;if(a===null){a=null;}b.onConnState=a;if(!(b.onConnState===null)&&!(b.latestConnState==="")){$s=1;continue;}$s=2;continue;case 1:c=R("NinchatClient.Session onConnState callback",b.onConnState,new BL([new $String(b.latestConnState)]));$s=3;case 3:if($c){$c=false;c=c.$blk();}if(c&&c.$blk!==undefined){break s;}c;case 2:$s=-1;case-1:}return;}if($f===undefined){$f={$blk:AP.ptr.prototype.OnConnState};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.$s=$s;$f.$r=$r;return $f;};AP.prototype.OnConnState=function(a){return this.$val.OnConnState(a);};AP.ptr.prototype.OnConnActive=function(a){var $ptr,a,b,c,d,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:b=this;if(a===null){a=null;}b.onConnActive=a;if(!(b.onConnActive===null)&&(c=b.latestConnActive,(c.$high>0||(c.$high===0&&c.$low>0)))){$s=1;continue;}$s=2;continue;case 1:d=R("NinchatClient.Session onConnActive callback",b.onConnActive,new BL([b.latestConnActive]));$s=3;case 3:if($c){$c=false;d=d.$blk();}if(d&&d.$blk!==undefined){break s;}d;case 2:$s=-1;case-1:}return;}if($f===undefined){$f={$blk:AP.ptr.prototype.OnConnActive};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.$s=$s;$f.$r=$r;return $f;};AP.prototype.OnConnActive=function(a){return this.$val.OnConnActive(a);};AP.ptr.prototype.OnLog=function(a){var $ptr,a,b;b=this;if(a===null){a=null;}b.onLog=a;};AP.prototype.OnLog=function(a){return this.$val.OnLog(a);};AP.ptr.prototype.SetParams=function(a){var $ptr,a,b,c,d,e;b=this;if((c=a["message_types"],c!==undefined?c.v:null)===null){$panic(new $String("message_types parameter not defined"));}e=(d=a["session_id"],d!==undefined?d.v:null);if(!(e===null)){b.sessionId=e;}delete a["session_id"];b.sessionParams=a;if(!(b.sendNotify===BX.nil)&&b.stopped){$go($methodVal(b,"discover"),[]);}};AP.prototype.SetParams=function(a){return this.$val.SetParams(a);};AP.ptr.prototype.SetTransport=function(a){var $ptr,a,b,c,d;b=this;if(a===null){b.forceLongPoll=false;return;}c=$internalize(a,$String);d=c;if(d==="websocket"){$panic(new $String("websocket transport cannot be forced"));}else if(d==="longpoll"){b.forceLongPoll=true;}else{$panic(new $String("unknown transport: "+c));}};AP.prototype.SetTransport=function(a){return this.$val.SetTransport(a);};AP.ptr.prototype.SetAddress=function(a){var $ptr,a,b;b=this;b.address=E(a);};AP.prototype.SetAddress=function(a){return this.$val.SetAddress(a);};AP.ptr.prototype.Open=function(){var $ptr,a;a=this;if(a.closed){$panic(new $String("session already closed"));}if(!(a.sendNotify===BX.nil)){$panic(new $String("session already initialized"));}if(a.onSessionEvent===null){$panic(new $String("onSessionEvent callback not defined"));}if(a.onEvent===null){$panic(new $String("onEvent callback not defined"));}if(a.sessionParams===false){$panic(new $String("session parameters not defined"));}a.sendNotify=new BX(1);a.closeNotify=new BX(1);a.stopped=false;$go($methodVal(a,"discover"),[]);};AP.prototype.Open=function(){return this.$val.Open();};AP.ptr.prototype.Close=function(){var $ptr,a,b,c,d,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:a=[a];a[0]=this;if(a[0].closed){return;}b=a[0].sendBuffer;c=0;case 1:if(!(c<b.$length)){$s=2;continue;}d=((c<0||c>=b.$length)?$throwRuntimeError("index out of range"):b.$array[b.$offset+c]);if(!(d.Deferred===BU.nil)){$s=3;continue;}$s=4;continue;case 3:$r=d.Deferred.Reject(new BL([]));$s=5;case 5:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 4:c++;$s=1;continue;case 2:a[0].sendBuffer=BZ.nil;a[0].numSent=0;a[0].closed=true;a[0].stopped=true;$go((function(a){return function $b(){var $ptr,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=$send(a[0].closeNotify,true);$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$close(a[0].sendNotify);$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.$s=$s;$f.$r=$r;return $f;};})(a),[]);$s=-1;case-1:}return;}if($f===undefined){$f={$blk:AP.ptr.prototype.Close};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.$s=$s;$f.$r=$r;return $f;};AP.prototype.Close=function(){return this.$val.Close();};AP.ptr.prototype.Send=function(a,b){var $ptr,a,b,c,d,e,f,g,h;c=$ifaceNil;d=this;if(d.sendNotify===BX.nil){$panic(new $String("session not initialized"));}if(d.closed){$panic(new $String("session already closed"));}if(b===undefined||b===null||($parseInt(b.length)===0)){b=null;}e=new D.ptr(new $Uint64(0,0),a,b,BU.nil,"");if(a.action_id===null){delete a[$externalize("action_id",$String)];}else{d.lastActionId=(f=d.lastActionId,g=new $Uint64(0,1),new $Uint64(f.$high+g.$high,f.$low+g.$low));e.Id=d.lastActionId;a.action_id=$externalize(e.Id,$Uint64);h=AM();e.Deferred=h[0];c=new BK(h[1]);}d.send(e);return c;};AP.prototype.Send=function(a,b){return this.$val.Send(a,b);};AP.ptr.prototype.send=function(a){var $ptr,a,b;b=this;b.sendBuffer=$append(b.sendBuffer,a);$go((function $b(){var $ptr,c,$r;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;c=$f.c;$r=$f.$r;}c=$select([[b.sendNotify,true],[]]);if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.c=c;$f.$r=$r;return $f;}),[]);return;};AP.prototype.send=function(a){return this.$val.send(a);};AP.ptr.prototype.sendAck=function(){var $ptr,a;a=this;a.sendEventAck=true;$go((function $b(){var $ptr,b,$r;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;b=$f.b;$r=$f.$r;}b=$select([[a.sendNotify,true],[]]);if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.b=b;$f.$r=$r;return $f;}),[]);};AP.prototype.sendAck=function(){return this.$val.sendAck();};AP.ptr.prototype.discover=function(){var $ptr,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,$s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;q=$f.q;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);a=[a];b=this;$r=b.log(new BL([new $String("opening")]));$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$deferred.push([$methodVal(b,"log"),[new BL([new $String("closed")])]]);$deferred.push([$methodVal(b,"connState"),["disconnected"]]);a[0]=$clone(new L.ptr(),L);case 2:if(!(!b.stopped)){$s=3;continue;}$r=b.log(new BL([new $String("endpoint discovery")]));$s=4;case 4:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=b.connState("connecting");$s=5;case 5:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}c="https://"+b.address+"/v2/endpoint";d=BH(c,"",O(new AS(0,7000),0.1));e=d[0];f=d[1];if(!($interfaceIsEqual(f,$ifaceNil))){$s=6;continue;}$s=7;continue;case 6:$r=b.log(new BL([new $String("endpoint discovery:"),f]));$s=9;case 9:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=8;continue;case 7:h=$select([[e],[b.closeNotify]]);$s=10;case 10:if($c){$c=false;h=h.$blk();}if(h&&h.$blk!==undefined){break s;}g=h;if(g[0]===0){$s=11;continue;}if(g[0]===1){$s=12;continue;}$s=13;continue;case 11:i=g[1];j=i[0];k=i[1];if(!k){$s=14;continue;}if(j===""){$s=15;continue;}$s=16;continue;case 14:$r=b.log(new BL([new $String("endpoint discovery timeout")]));$s=18;case 18:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=17;continue;case 15:$r=b.log(new BL([new $String("endpoint discovery error")]));$s=19;case 19:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=17;continue;case 16:l=F(j);m=l[0];n=l[1];if(!($interfaceIsEqual(n,$ifaceNil))){$s=20;continue;}$s=21;continue;case 20:$r=b.log(new BL([new $String("endpoint discovery:"),n]));$s=23;case 23:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=22;continue;case 21:$r=b.log(new BL([new $String("endpoint discovered")]));$s=24;case 24:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}if($pkg.WebSocketSupported&&!b.forceLongPoll){$s=25;continue;}$s=26;continue;case 25:o=b.connect(BA,m,a[0]);$s=29;case 29:if($c){$c=false;o=o.$blk();}if(o&&o.$blk!==undefined){break s;}if(o){$s=27;continue;}$s=28;continue;case 27:$s=2;continue;case 28:case 26:p=b.connect(AF,m,a[0]);$s=30;case 30:if($c){$c=false;p=p.$blk();}if(p&&p.$blk!==undefined){break s;}p;case 22:case 17:$s=13;continue;case 12:return;case 13:case 8:q=a[0].Failure(new AS(0,60000));if((q.$high>0||(q.$high===0&&q.$low>0))){$s=31;continue;}$s=32;continue;case 31:$r=b.log(new BL([new $String("sleeping")]));$s=33;case 33:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=b.connState("disconnected");$s=34;case 34:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=AW(q);$s=35;case 35:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 32:$s=2;continue;case 3:$s=-1;case-1:}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if($curGoroutine.asleep){if($f===undefined){$f={$blk:AP.ptr.prototype.discover};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.q=q;$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}};AP.prototype.discover=function(){return this.$val.discover();};AP.ptr.prototype.connect=function(a,b,c){var $ptr,a,b,c,d,e,f,g,h,i,j,k,l,m,n,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:d=false;e=this;f=0;case 1:if(!(f<2)){$s=2;continue;}g=b;h=0;case 3:if(!(h<g.$length)){$s=4;continue;}i=((h<0||h>=g.$length)?$throwRuntimeError("index out of range"):g.$array[g.$offset+h]);$r=e.connState("connecting");$s=5;case 5:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}k=a(e,i);$s=6;case 6:if($c){$c=false;k=k.$blk();}if(k&&k.$blk!==undefined){break s;}j=k;l=j[0];m=j[1];if(l){d=true;}if(m){c.Success();return d;}if(e.stopped){return d;}n=c.Failure(new AS(0,60000));if((n.$high>0||(n.$high===0&&n.$low>0))){$s=7;continue;}$s=8;continue;case 7:$r=e.log(new BL([new $String("sleeping")]));$s=9;case 9:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=e.connState("disconnected");$s=10;case 10:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=AW(n);$s=11;case 11:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 8:h++;$s=3;continue;case 4:f=f+(1)>>0;$s=1;continue;case 2:return d;$s=-1;case-1:}return;}if($f===undefined){$f={$blk:AP.ptr.prototype.connect};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.$s=$s;$f.$r=$r;return $f;};AP.prototype.connect=function(a,b,c){return this.$val.connect(a,b,c);};AP.ptr.prototype.canLogin=function(){var $ptr,a,b,c,d,e,f,g,h;a=this;if(!((b=a.sessionParams["access_key"],b!==undefined?b.v:null)===null)){return true;}if(!((c=a.sessionParams["user_id"],c!==undefined?c.v:null)===null)){return!((d=a.sessionParams["user_auth"],d!==undefined?d.v:null)===null)||!((e=a.sessionParams["master_sign"],e!==undefined?e.v:null)===null);}return!((f=a.sessionParams["identity_type"],f!==undefined?f.v:null)===null)&&!((g=a.sessionParams["identity_name"],g!==undefined?g.v:null)===null)&&!((h=a.sessionParams["identity_auth"],h!==undefined?h.v:null)===null);};AP.prototype.canLogin=function(){return this.$val.canLogin();};AP.ptr.prototype.makeCreateSessionAction=function(){var $ptr,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;a=null;b=this;a=X();a.action=$externalize("create_session",$String);d=(c=b.sessionParams["user_id"],c!==undefined?c.v:null);if(d===null){e=b.sessionParams;f=0;g=$keys(e);while(true){if(!(f<g.length)){break;}h=e[g[f]];if(h===undefined){f++;continue;}i=h.k;j=h.v;a[$externalize(i,$String)]=j;f++;}}else{l=(k=b.sessionParams["user_auth"],k!==undefined?k.v:null);if(!(l===null)){a.user_id=d;a.user_auth=l;}else{n=(m=b.sessionParams["master_sign"],m!==undefined?m.v:null);if(!(n===null)){a.user_id=d;a.master_sign=n;}else{p=(o=b.sessionParams["identity_type"],o!==undefined?o.v:null);if(!(p===null)){a.identity_type=p;a.identity_name=(q=b.sessionParams["identity_name"],q!==undefined?q.v:null);a.identity_auth=(r=b.sessionParams["identity_auth"],r!==undefined?r.v:null);}else{a.user_id=d;}}}s=b.sessionParams;t=0;u=$keys(s);while(true){if(!(t<u.length)){break;}v=s[u[t]];if(v===undefined){t++;continue;}w=v.k;x=v.v;y=w;if(y==="user_id"||y==="user_auth"||y==="identity_type"||y==="identity_name"||y==="identity_auth"||y==="access_key"||y==="master_sign"){}else{a[$externalize(w,$String)]=x;}t++;}}return a;};AP.prototype.makeCreateSessionAction=function(){return this.$val.makeCreateSessionAction();};AP.ptr.prototype.makeResumeSessionAction=function(a){var $ptr,a,b,c;b=null;c=this;b=X();b.action=$externalize("resume_session",$String);b.event_id=$externalize(c.receivedEventId,$Uint64);if(a){b.session_id=c.sessionId;}c.sendEventAck=false;c.ackedEventId=c.receivedEventId;return b;};AP.prototype.makeResumeSessionAction=function(a){return this.$val.makeResumeSessionAction(a);};AP.ptr.prototype.handleSessionEvent=function(a){var $ptr,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;q=$f.q;r=$f.r;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:b=false;c=this;d=G(a);e=d[0];f=d[1];g=d[2];h=d[3];b=d[4];i=d[5];if(!($interfaceIsEqual(i,$ifaceNil))){$s=1;continue;}$s=2;continue;case 1:$r=c.log(new BL([new $String("session creation:"),i]));$s=3;case 3:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 2:j=R("NinchatClient.Session onSessionEvent callback",c.onSessionEvent,new BL([new $jsObjectPtr(a)]));$s=6;case 6:if($c){$c=false;j=j.$blk();}if(j&&j.$blk!==undefined){break s;}if(!j){$s=4;continue;}$s=5;continue;case 4:b=false;case 5:if(!b){c.sessionId=null;c.stopped=true;return b;}delete c.sessionParams["user_attrs"];delete c.sessionParams["user_settings"];delete c.sessionParams["identity_attrs"];delete c.sessionParams["access_key"];delete c.sessionParams["master_sign"];k="user_id";(c.sessionParams||$throwRuntimeError("assignment to entry in nil map"))[k]={k:k,v:e};if(!(f===null)){l="user_auth";(c.sessionParams||$throwRuntimeError("assignment to entry in nil map"))[l]={k:l,v:f};}m=new BJ(["identity_type","identity_name","identity_auth"]);n=0;while(true){if(!(n<m.$length)){break;}o=((n<0||n>=m.$length)?$throwRuntimeError("index out of range"):m.$array[m.$offset+n]);q=(p=c.sessionParams[o+"_new"],p!==undefined?p.v:null);if(!(q===null)){delete c.sessionParams[o+"_new"];r=o;(c.sessionParams||$throwRuntimeError("assignment to entry in nil map"))[r]={k:r,v:q};}n++;}c.sessionId=g;if(c.sendBuffer.$length===0){c.lastActionId=new $Uint64(0,0);}c.sendEventAck=false;c.receivedEventId=h;c.ackedEventId=new $Uint64(0,0);$r=c.log(new BL([new $String("session created")]));$s=7;case 7:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}b=true;return b;$s=-1;case-1:}return;}if($f===undefined){$f={$blk:AP.ptr.prototype.handleSessionEvent};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.q=q;$f.r=r;$f.$s=$s;$f.$r=$r;return $f;};AP.prototype.handleSessionEvent=function(a){return this.$val.handleSessionEvent(a);};AP.ptr.prototype.handleEvent=function(a,b){var $ptr,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;q=$f.q;r=$f.r;s=$f.s;t=$f.t;u=$f.u;v=$f.v;w=$f.w;x=$f.x;y=$f.y;z=$f.z;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:c=[c];d=[d];c[0]=new $Uint64(0,0);e=false;f=false;g=false;d[0]=this;h=I(a);i=h[0];c[0]=h[1];j=h[2];if(!($interfaceIsEqual(j,$ifaceNil))){$s=1;continue;}$s=2;continue;case 1:$r=d[0].log(new BL([new $String("event:"),j]));$s=3;case 3:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return[c[0],e,f,g];case 2:if((i.$high>0||(i.$high===0&&i.$low>0))){d[0].receivedEventId=i;if(!d[0].sendEventAck){if((k=(l=d[0].receivedEventId,m=d[0].ackedEventId,new $Uint64(l.$high-m.$high,l.$low-m.$low)),(k.$high>AN.$high||(k.$high===AN.$high&&k.$low>=AN.$low)))){d[0].sendAck();}else{f=true;}}}if((c[0].$high>0||(c[0].$high===0&&c[0].$low>0))){$s=4;continue;}$s=5;continue;case 4:n=C.Search(d[0].numSent,(function(c,d){return function(n){var $ptr,n,o,p,q;p=(o=d[0].sendBuffer,((n<0||n>=o.$length)?$throwRuntimeError("index out of range"):o.$array[o.$offset+n]));return(q=p.Id,(q.$high>c[0].$high||(q.$high===c[0].$high&&q.$low>=c[0].$low)));};})(c,d));$s=6;case 6:if($c){$c=false;n=n.$blk();}if(n&&n.$blk!==undefined){break s;}o=n;if(o<d[0].numSent){$s=7;continue;}$s=8;continue;case 7:q=(p=d[0].sendBuffer,((o<0||o>=p.$length)?$throwRuntimeError("index out of range"):p.$array[p.$offset+o]));if((r=q.Id,(r.$high===c[0].$high&&r.$low===c[0].$low))){$s=9;continue;}$s=10;continue;case 9:s=J(a,q);t=s[0];u=s[1];if(!($interfaceIsEqual(u,$ifaceNil))){$s=11;continue;}$s=12;continue;case 11:$r=d[0].log(new BL([new $String("event:"),u]));$s=13;case 13:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return[c[0],e,f,g];case 12:if(!(q.Deferred===BU.nil)){$s=14;continue;}$s=15;continue;case 14:if(t){$s=16;continue;}$s=17;continue;case 16:$r=q.Deferred.Resolve(new BL([new $jsObjectPtr(a),new $jsObjectPtr(b)]));$s=19;case 19:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=18;continue;case 17:$r=q.Deferred.Notify(new BL([new $jsObjectPtr(a),new $jsObjectPtr(b)]));$s=20;case 20:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 18:case 15:if(t){d[0].sendBuffer=$appendSlice($subslice(d[0].sendBuffer,0,o),$subslice(d[0].sendBuffer,(o+1>>0)));d[0].numSent=d[0].numSent-(1)>>0;}case 10:case 8:case 5:v=K(a);w=v[0];x=v[1];e=v[2];j=v[3];if(!($interfaceIsEqual(j,$ifaceNil))){$s=21;continue;}$s=22;continue;case 21:$r=d[0].log(new BL([new $String("event:"),j]));$s=23;case 23:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}if(e){$s=24;continue;}$s=25;continue;case 24:d[0].sessionId=null;if(!d[0].canLogin()){$s=26;continue;}$s=27;continue;case 26:y=R("NinchatClient.Session onSessionEvent callback",d[0].onSessionEvent,new BL([new $jsObjectPtr(a)]));$s=28;case 28:if($c){$c=false;y=y.$blk();}if(y&&y.$blk!==undefined){break s;}y;d[0].stopped=true;case 27:case 25:return[c[0],e,f,g];case 22:if(w==="deprecated"){$s=29;continue;}$s=30;continue;case 29:$r=d[0].log(new BL([new $String("deprecated:"),new $String(x)]));$s=31;case 31:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 30:z=R("NinchatClient.Session onEvent callback",d[0].onEvent,new BL([new $jsObjectPtr(a),new $jsObjectPtr(b)]));$s=34;case 34:if($c){$c=false;z=z.$blk();}if(z&&z.$blk!==undefined){break s;}if(!z){$s=32;continue;}$s=33;continue;case 32:return[c[0],e,f,g];case 33:g=true;return[c[0],e,f,g];$s=-1;case-1:}return;}if($f===undefined){$f={$blk:AP.ptr.prototype.handleEvent};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.q=q;$f.r=r;$f.s=s;$f.t=t;$f.u=u;$f.v=v;$f.w=w;$f.x=x;$f.y=y;$f.z=z;$f.$s=$s;$f.$r=$r;return $f;};AP.prototype.handleEvent=function(a,b){return this.$val.handleEvent(a,b);};AP.ptr.prototype.connState=function(a){var $ptr,a,b,c,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:b=this;if(!(b.latestConnState===a)){$s=1;continue;}$s=2;continue;case 1:b.latestConnState=a;if(!(b.onConnState===null)){$s=3;continue;}$s=4;continue;case 3:c=R("NinchatClient.Session onConnState callback",b.onConnState,new BL([new $String(b.latestConnState)]));$s=5;case 5:if($c){$c=false;c=c.$blk();}if(c&&c.$blk!==undefined){break s;}c;case 4:case 2:$s=-1;case-1:}return;}if($f===undefined){$f={$blk:AP.ptr.prototype.connState};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.$s=$s;$f.$r=$r;return $f;};AP.prototype.connState=function(a){return this.$val.connState(a);};AP.ptr.prototype.connActive=function(){var $ptr,a,b,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:a=this;a.latestConnActive=AT();if(!(a.onConnActive===null)){$s=1;continue;}$s=2;continue;case 1:b=R("NinchatClient.Session onConnActive callback",a.onConnActive,new BL([a.latestConnActive]));$s=3;case 3:if($c){$c=false;b=b.$blk();}if(b&&b.$blk!==undefined){break s;}b;case 2:$s=-1;case-1:}return;}if($f===undefined){$f={$blk:AP.ptr.prototype.connActive};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.$s=$s;$f.$r=$r;return $f;};AP.prototype.connActive=function(){return this.$val.connActive();};AP.ptr.prototype.log=function(a){var $ptr,a,b,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:b=this;$r=AE("NinchatClient.Session onLog callback",b.onLog,a);$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;case-1:}return;}if($f===undefined){$f={$blk:AP.ptr.prototype.log};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.$s=$s;$f.$r=$r;return $f;};AP.prototype.log=function(a){return this.$val.log(a);};AT=function(){var $ptr,a;return(a=$internalize(new($global.Date)().getTime(),$Int64),new AR(a.$high,a.$low));};$pkg.Now=AT;AV=function(a){var $ptr,a,b;b=CE.nil;b=new AU.ptr(new BX(0),null);if((a.$high>0||(a.$high===0&&a.$low>=0))){b.Reset(a);}return b;};$pkg.NewTimer=AV;AU.ptr.prototype.Active=function(){var $ptr,a;a=this;return!(a.id===null);};AU.prototype.Active=function(){return this.$val.Active();};AU.ptr.prototype.Reset=function(a){var $ptr,a,b;b=this;b.Stop();b.id=AC((function(){var $ptr;b.id=null;$go((function $b(){var $ptr,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=$send(b.C,true);$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.$s=$s;$f.$r=$r;return $f;}),[]);}),a);};AU.prototype.Reset=function(a){return this.$val.Reset(a);};AU.ptr.prototype.Stop=function(){var $ptr,a;a=this;if(!(a.id===null)){AD(a.id);a.id=null;}};AU.prototype.Stop=function(){return this.$val.Stop();};AW=function(a){var $ptr,a,b,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:b=$recv(AV(a).C);$s=1;case 1:if($c){$c=false;b=b.$blk();}if(b&&b.$blk!==undefined){break s;}b[0];$s=-1;case-1:}return;}if($f===undefined){$f={$blk:AW};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.$s=$s;$f.$r=$r;return $f;};$pkg.Sleep=AW;AY=function(a){var $ptr,a,b;b=CF.nil;b=new AX.ptr(new BX(1),false,new($global.WebSocket)($externalize(a,$String)),false,$ifaceNil,BV.nil);b.impl.binaryType=$externalize("arraybuffer",$String);b.impl.onopen=$externalize((function(c){var $ptr,c;b.open=true;$go((function $b(){var $ptr,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=$send(b.Notify,true);$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.$s=$s;$f.$r=$r;return $f;}),[]);}),CA);b.impl.onmessage=$externalize((function(c){var $ptr,c;b.buffer=$append(b.buffer,c.data);$go((function $b(){var $ptr,d,$r;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;d=$f.d;$r=$f.$r;}d=$select([[b.Notify,true],[]]);if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.d=d;$f.$r=$r;return $f;}),[]);}),CA);b.impl.onclose=$externalize((function(c){var $ptr,c;b.GoingAway=($parseInt(c.code)>>0)===1001;b.open=false;$go((function(){var $ptr;$close(b.Notify);}),[]);}),CA);b.impl.onerror=$externalize((function(c){var $ptr,c;b.error=A.New("WebSocket error event");}),CA);return b;};$pkg.NewWebSocket=AY;AX.ptr.prototype.Send=function(a){var $ptr,a,b,c,$deferred;var $err=null;try{$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);b=$ifaceNil;c=this;$deferred.push([(function(){var $ptr;b=Q($recover());}),[]]);b=c.error;if(!($interfaceIsEqual(b,$ifaceNil))){return b;}c.impl.send($externalize(a,$emptyInterface));return b;}catch(err){$err=err;}finally{$callDeferred($deferred,$err);if(!$curGoroutine.asleep){return b;}}};AX.prototype.Send=function(a){return this.$val.Send(a);};AX.ptr.prototype.SendJSON=function(a){var $ptr,a,b,c,d,e;b=$ifaceNil;c=this;d=AA(a);e=d[0];b=d[1];if(!($interfaceIsEqual(b,$ifaceNil))){return b;}b=c.Send(new $String(e));return b;};AX.prototype.SendJSON=function(a){return this.$val.SendJSON(a);};AX.ptr.prototype.Receive=function(){var $ptr,a,b,c,d;a=null;b=$ifaceNil;c=this;b=c.error;if(!($interfaceIsEqual(b,$ifaceNil))){return[a,b];}if(!c.open){return[a,b];}if(c.buffer.$length>0){a=(d=c.buffer,(0>=d.$length?$throwRuntimeError("index out of range"):d.$array[d.$offset+0]));c.buffer=$subslice(c.buffer,1);}return[a,b];};AX.prototype.Receive=function(){return this.$val.Receive();};AX.ptr.prototype.ReceiveJSON=function(){var $ptr,a,b,c,d,e,f;a=null;b=$ifaceNil;c=this;d=c.Receive();e=d[0];b=d[1];if(!($interfaceIsEqual(b,$ifaceNil))||e===null){return[a,b];}f=Z(AZ(e));a=f[0];b=f[1];return[a,b];};AX.prototype.ReceiveJSON=function(){return this.$val.ReceiveJSON();};AX.ptr.prototype.Close=function(){var $ptr,a,b,$deferred;var $err=null;try{$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);a=$ifaceNil;b=this;$deferred.push([(function(){var $ptr;a=Q($recover());}),[]]);b.impl.close();a=b.error;return a;}catch(err){$err=err;}finally{$callDeferred($deferred,$err);if(!$curGoroutine.asleep){return a;}}};AX.prototype.Close=function(){return this.$val.Close();};AZ=function(a){var $ptr,a,b,c,d,e,f;b="";c=$assertType($internalize(a,$emptyInterface),$String,true);b=c[0];d=c[1];if(d){return b;}e=W(a);f=$assertType($internalize(e,$emptyInterface),CG);b=$bytesToString(f);return b;};$pkg.StringifyFrame=AZ;BA=function(a,b){var $ptr,a,b,c,d,e,f,g,h,i,j,k,l,m,$s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);c=[c];d=false;e=false;c[0]=CF.nil;$deferred.push([(function(c){return function(){var $ptr;if(!(c[0]===CF.nil)){c[0].Close();}};})(c),[]]);f=AV(new AS(-1,4294967295));$deferred.push([$methodVal(f,"Stop"),[]]);case 1:e=false;g=false;$r=a.log(new BL([new $String("connecting to"),new $String(b)]));$s=3;case 3:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}c[0]=AY("wss://"+b+"/v2/socket");f.Reset(O(new AS(0,9000),0.1));i=$select([[c[0].Notify],[f.C],[a.closeNotify]]);$s=4;case 4:if($c){$c=false;i=i.$blk();}if(i&&i.$blk!==undefined){break s;}h=i;if(h[0]===0){$s=5;continue;}if(h[0]===1){$s=6;continue;}if(h[0]===2){$s=7;continue;}$s=8;continue;case 5:j=h[1][0];f.Stop();if(j){$s=9;continue;}$s=10;continue;case 9:$r=a.log(new BL([new $String("connected")]));$s=12;case 12:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=a.connState("connected");$s=13;case 13:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}d=true;l=BB(a,c[0]);$s=14;case 14:if($c){$c=false;l=l.$blk();}if(l&&l.$blk!==undefined){break s;}k=l;e=k[0];g=k[1];$s=11;continue;case 10:$r=a.log(new BL([new $String("connection failed")]));$s=15;case 15:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 11:$s=8;continue;case 6:$r=a.log(new BL([new $String("connection timeout")]));$s=16;case 16:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=8;continue;case 7:f.Stop();case 8:m=c[0].GoingAway;c[0].Close();c[0]=CF.nil;if(m){$s=17;continue;}$s=18;continue;case 17:$r=a.log(new BL([new $String("disconnected (server is going away)")]));$s=20;case 20:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=19;continue;case 18:$r=a.log(new BL([new $String("disconnected")]));$s=21;case 21:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 19:if(!e||!g||a.stopped||m){return[d,e];}$s=1;continue;case 2:$s=-1;case-1:}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if(!$curGoroutine.asleep){return[d,e];}if($curGoroutine.asleep){if($f===undefined){$f={$blk:BA};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}};$pkg.WebSocketTransport=BA;BB=function(a,b){var $ptr,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;q=$f.q;r=$f.r;s=$f.s;t=$f.t;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:c=false;d=false;e=null;if(a.sessionId===null){$s=1;continue;}$s=2;continue;case 1:$r=a.log(new BL([new $String("session creation")]));$s=4;case 4:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}e=a.makeCreateSessionAction();$s=3;continue;case 2:$r=a.log(new BL([new $String("session resumption")]));$s=5;case 5:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}e=a.makeResumeSessionAction(true);case 3:f=b.SendJSON(new $jsObjectPtr(e));if(!($interfaceIsEqual(f,$ifaceNil))){$s=6;continue;}$s=7;continue;case 6:$r=a.log(new BL([new $String("send:"),f]));$s=8;case 8:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 7:if(a.sessionId===null){$s=9;continue;}$s=10;continue;case 9:g=null;h=AV(O(new AS(0,13000),0.2));case 11:i=$ifaceNil;j=b.ReceiveJSON();g=j[0];i=j[1];if(!($interfaceIsEqual(i,$ifaceNil))){$s=13;continue;}$s=14;continue;case 13:$r=a.log(new BL([new $String("session creation:"),i]));$s=15;case 15:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return[c,d];case 14:if(!(g===null)){h.Stop();$s=12;continue;}l=$select([[b.Notify],[h.C]]);$s=16;case 16:if($c){$c=false;l=l.$blk();}if(l&&l.$blk!==undefined){break s;}k=l;if(k[0]===0){$s=17;continue;}if(k[0]===1){$s=18;continue;}$s=19;continue;case 17:m=k[1][0];if(!m){$s=20;continue;}$s=21;continue;case 20:$r=a.log(new BL([new $String("disconnected during session creation")]));$s=22;case 22:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}h.Stop();return[c,d];case 21:$s=19;continue;case 18:$r=a.log(new BL([new $String("session creation timeout")]));$s=23;case 23:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return[c,d];case 19:$s=11;continue;case 12:n=a.handleSessionEvent(g);$s=26;case 26:if($c){$c=false;n=n.$blk();}if(n&&n.$blk!==undefined){break s;}if(!n){$s=24;continue;}$s=25;continue;case 24:return[c,d];case 25:c=true;d=true;$r=a.connActive();$s=27;case 27:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 10:o=new BX(1);p=new BX(0);$go(BC,[a,b,o,p]);r=BD(a,b,o);$s=28;case 28:if($c){$c=false;r=r.$blk();}if(r&&r.$blk!==undefined){break s;}q=r;s=q[0];d=q[1];if(s){c=true;}t=$recv(p);$s=29;case 29:if($c){$c=false;t=t.$blk();}if(t&&t.$blk!==undefined){break s;}t[0];return[c,d];$s=-1;case-1:}return;}if($f===undefined){$f={$blk:BB};}$f.$ptr=$ptr;$f.a=a;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.q=q;$f.r=r;$f.s=s;$f.t=t;$f.$s=$s;$f.$r=$r;return $f;};BC=function(a,b,c,d){var $ptr,a,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,$s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;aa=$f.aa;ab=$f.ab;ac=$f.ac;ad=$f.ad;ae=$f.ae;af=$f.af;ag=$f.ag;ah=$f.ah;ai=$f.ai;aj=$f.aj;ak=$f.ak;al=$f.al;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;q=$f.q;r=$f.r;s=$f.s;t=$f.t;u=$f.u;v=$f.v;w=$f.w;x=$f.x;y=$f.y;z=$f.z;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);d=[d];$deferred.push([(function(d){return function $b(){var $ptr,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=$send(d[0],true);$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.$s=$s;$f.$r=$r;return $f;};})(d),[]]);e=AV(O(new AS(0,56000),-0.3));$deferred.push([$methodVal(e,"Stop"),[]]);a.numSent=0;case 1:case 3:if(!(a.numSent<a.sendBuffer.$length)){$s=4;continue;}h=(f=a.sendBuffer,g=a.numSent,((g<0||g>=f.$length)?$throwRuntimeError("index out of range"):f.$array[f.$offset+g]));if(!(h.Payload===null)){h.Header.frames=$parseInt(h.Payload.length);}if(!((i=a.receivedEventId,j=a.ackedEventId,(i.$high===j.$high&&i.$low===j.$low)))){h.Header.event_id=$externalize(a.receivedEventId,$Uint64);a.sendEventAck=false;a.ackedEventId=a.receivedEventId;}k=b.SendJSON(new $jsObjectPtr(h.Header));delete h.Header[$externalize("frames",$String)];delete h.Header[$externalize("event_id",$String)];if(!($interfaceIsEqual(k,$ifaceNil))){$s=5;continue;}$s=6;continue;case 5:$r=a.log(new BL([new $String("send:"),k]));$s=7;case 7:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=$send(c,true);$s=8;case 8:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return;case 6:if(!(h.Payload===null)){$s=9;continue;}$s=10;continue;case 9:l=0;case 11:if(!(l<$parseInt(h.Payload.length))){$s=12;continue;}m=h.Payload[l];if($internalize(h.Header.action,$String)==="update_user"){$s=13;continue;}$s=14;continue;case 13:n=$assertType($internalize(m,$emptyInterface),$String,true);o=n[1];if(o){$s=15;continue;}$s=16;continue;case 15:p=T(m);q=p[0];r=p[1];if(!($interfaceIsEqual(r,$ifaceNil))){$s=17;continue;}$s=18;continue;case 17:$r=a.log(new BL([new $String("send:"),r]));$s=19;case 19:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=$send(c,true);$s=20;case 20:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return;case 18:s=S(q);t=s[0];r=s[1];if(!($interfaceIsEqual(r,$ifaceNil))){$s=21;continue;}$s=22;continue;case 21:$r=a.log(new BL([new $String("send:"),r]));$s=23;case 23:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=$send(c,true);$s=24;case 24:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return;case 22:u=$parseInt(t.length);v=V(u);w=W(v);x=0;while(true){if(!(x<u)){break;}w[x]=t.charCodeAt(x);x=x+(1)>>0;}m=v;case 16:case 14:y=b.Send(new $jsObjectPtr(m));if(!($interfaceIsEqual(y,$ifaceNil))){$s=25;continue;}$s=26;continue;case 25:$r=a.log(new BL([new $String("send:"),y]));$s=27;case 27:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=$send(c,true);$s=28;case 28:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return;case 26:l=l+(1)>>0;$s=11;continue;case 12:case 10:if((z=h.Id,(z.$high===0&&z.$low===0))){a.sendBuffer=$appendSlice($subslice(a.sendBuffer,0,a.numSent),$subslice(a.sendBuffer,(a.numSent+1>>0)));}else{a.numSent=a.numSent+(1)>>0;}e.Reset(O(new AS(0,56000),-0.3));$s=3;continue;case 4:if(a.sendEventAck&&!((aa=a.receivedEventId,ab=a.ackedEventId,(aa.$high===ab.$high&&aa.$low===ab.$low)))){$s=29;continue;}$s=30;continue;case 29:ac=a.makeResumeSessionAction(false);ad=b.SendJSON(new $jsObjectPtr(ac));if(!($interfaceIsEqual(ad,$ifaceNil))){$s=31;continue;}$s=32;continue;case 31:$r=a.log(new BL([new $String("send:"),ad]));$s=33;case 33:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=$send(c,true);$s=34;case 34:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return;case 32:case 30:af=$select([[a.sendNotify],[e.C],[c]]);$s=35;case 35:if($c){$c=false;af=af.$blk();}if(af&&af.$blk!==undefined){break s;}ae=af;if(ae[0]===0){$s=36;continue;}if(ae[0]===1){$s=37;continue;}if(ae[0]===2){$s=38;continue;}$s=39;continue;case 36:ag=ae[1][0];if(!ag){$s=40;continue;}$s=41;continue;case 40:ah=(ai=new $Map(),aj="action",ai[aj]={k:aj,v:new $String("close_session")},ai);ak=b.SendJSON(new BK(ah));if(!($interfaceIsEqual(ak,$ifaceNil))){$s=42;continue;}$s=43;continue;case 42:$r=a.log(new BL([new $String("send:"),ak]));$s=44;case 44:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}case 43:return;case 41:$s=39;continue;case 37:al=b.Send(new CG([]));if(!($interfaceIsEqual(al,$ifaceNil))){$s=45;continue;}$s=46;continue;case 45:$r=a.log(new BL([new $String("send:"),al]));$s=47;case 47:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=$send(c,true);$s=48;case 48:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return;case 46:e.Reset(O(new AS(0,56000),-0.3));$s=39;continue;case 38:return;case 39:$s=1;continue;case 2:$s=-1;case-1:}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if($curGoroutine.asleep){if($f===undefined){$f={$blk:BC};}$f.$ptr=$ptr;$f.a=a;$f.aa=aa;$f.ab=ab;$f.ac=ac;$f.ad=ad;$f.ae=ae;$f.af=af;$f.ag=ag;$f.ah=ah;$f.ai=ai;$f.aj=aj;$f.ak=ak;$f.al=al;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.q=q;$f.r=r;$f.s=s;$f.t=t;$f.u=u;$f.v=v;$f.w=w;$f.x=x;$f.y=y;$f.z=z;$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}};BD=function(a,b,c){var $ptr,a,aa,ab,ac,ad,ae,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,$s,$deferred,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;a=$f.a;aa=$f.aa;ab=$f.ab;ac=$f.ac;ad=$f.ad;ae=$f.ae;b=$f.b;c=$f.c;d=$f.d;e=$f.e;f=$f.f;g=$f.g;h=$f.h;i=$f.i;j=$f.j;k=$f.k;l=$f.l;m=$f.m;n=$f.n;o=$f.o;p=$f.p;q=$f.q;r=$f.r;s=$f.s;t=$f.t;u=$f.u;v=$f.v;w=$f.w;x=$f.x;y=$f.y;z=$f.z;$s=$f.$s;$deferred=$f.$deferred;$r=$f.$r;}var $err=null;try{s:while(true){switch($s){case 0:$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);d=false;e=false;f=null;g=null;h=0;i=AV(O(new AS(0,64000),0.3));$deferred.push([$methodVal(i,"Stop"),[]]);j=AV(new AS(-1,4294967295));$deferred.push([$methodVal(j,"Stop"),[]]);case 1:k=false;case 3:if(f===null){$s=5;continue;}$s=6;continue;case 5:l=$ifaceNil;m=b.Receive();n=m[0];l=m[1];if(!($interfaceIsEqual(l,$ifaceNil))){$s=8;continue;}$s=9;continue;case 8:$r=a.log(new BL([new $String("receive:"),l]));$s=10;case 10:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}e=false;$r=$send(c,true);$s=11;case 11:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return[d,e];case 9:if(n===null){$s=4;continue;}i.Reset(O(new AS(0,64000),0.7));$r=a.connActive();$s=12;case 12:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}o=AZ(n);if(o.length===0){$s=13;continue;}$s=14;continue;case 13:$s=3;continue;case 14:p=Z(o);f=p[0];l=p[1];if(!($interfaceIsEqual(l,$ifaceNil))){$s=15;continue;}$s=16;continue;case 15:$r=a.log(new BL([new $String("receive:"),l]));$s=17;case 17:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}e=false;$r=$send(c,true);$s=18;case 18:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return[d,e];case 16:g=U();q=H(f);h=q[0];l=q[1];if(!($interfaceIsEqual(l,$ifaceNil))){$s=19;continue;}$s=20;continue;case 19:$r=a.log(new BL([new $String("receive:"),l]));$s=21;case 21:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}e=false;$r=$send(c,true);$s=22;case 22:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return[d,e];case 20:$s=7;continue;case 6:r=b.Receive();s=r[0];t=r[1];if(!($interfaceIsEqual(t,$ifaceNil))){$s=23;continue;}$s=24;continue;case 23:$r=a.log(new BL([new $String("receive:"),t]));$s=25;case 25:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}e=false;$r=$send(c,true);$s=26;case 26:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return[d,e];case 24:if(s===null){$s=4;continue;}g.push(s);h=h-(1)>>0;case 7:if(h===0){$s=27;continue;}$s=28;continue;case 27:v=a.handleEvent(f,g);$s=29;case 29:if($c){$c=false;v=v.$blk();}if(v&&v.$blk!==undefined){break s;}u=v;w=u[1];x=u[2];y=u[3];if(!y){$s=30;continue;}$s=31;continue;case 30:if(w){d=true;}else{e=false;}$r=$send(c,true);$s=32;case 32:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return[d,e];case 31:if(x){k=true;}f=null;g=null;h=0;d=true;e=true;case 28:z=$select([[a.closeNotify],[c],[]]);if(z[0]===0){return[d,e];}else if(z[0]===1){return[d,e];}$s=3;continue;case 4:if(k&&!j.Active()){j.Reset(O(new AS(0,7000),-0.3));}ab=$select([[b.Notify],[i.C],[j.C],[a.closeNotify],[c]]);$s=33;case 33:if($c){$c=false;ab=ab.$blk();}if(ab&&ab.$blk!==undefined){break s;}aa=ab;if(aa[0]===0){$s=34;continue;}if(aa[0]===1){$s=35;continue;}if(aa[0]===2){$s=36;continue;}if(aa[0]===3){$s=37;continue;}if(aa[0]===4){$s=38;continue;}$s=39;continue;case 34:ac=aa[1][0];if(!ac){$s=40;continue;}$s=41;continue;case 40:$r=$send(c,true);$s=42;case 42:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return[d,e];case 41:$s=39;continue;case 35:$r=a.log(new BL([new $String("receive timeout")]));$s=43;case 43:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=$send(c,true);$s=44;case 44:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}return[d,e];$s=39;continue;case 36:if(!a.sendEventAck&&!((ad=a.ackedEventId,ae=a.receivedEventId,(ad.$high===ae.$high&&ad.$low===ae.$low)))){a.sendAck();}$s=39;continue;case 37:return[d,e];$s=39;continue;case 38:return[d,e];case 39:$s=1;continue;case 2:$s=-1;case-1:}return;}}catch(err){$err=err;$s=-1;}finally{$callDeferred($deferred,$err);if(!$curGoroutine.asleep){return[d,e];}if($curGoroutine.asleep){if($f===undefined){$f={$blk:BD};}$f.$ptr=$ptr;$f.a=a;$f.aa=aa;$f.ab=ab;$f.ac=ac;$f.ad=ad;$f.ae=ae;$f.b=b;$f.c=c;$f.d=d;$f.e=e;$f.f=f;$f.g=g;$f.h=h;$f.i=i;$f.j=j;$f.k=k;$f.l=l;$f.m=m;$f.n=n;$f.o=o;$f.p=p;$f.q=q;$f.r=r;$f.s=s;$f.t=t;$f.u=u;$f.v=v;$f.w=w;$f.x=x;$f.y=y;$f.z=z;$f.$s=$s;$f.$deferred=$deferred;$f.$r=$r;return $f;}}};BG=function(){var $ptr;BE=$global.XDomainRequest;if(BE===undefined){BE=$global.XMLHttpRequest;BF=true;}};BH=function(a,b,c){var $ptr,a,b,c,d,e,f,g,$deferred;var $err=null;try{$deferred=[];$deferred.index=$curGoroutine.deferStack.length;$curGoroutine.deferStack.push($deferred);d=CH.nil;e=$ifaceNil;$deferred.push([(function(){var $ptr;e=Q($recover());}),[]]);f="";if(b===""){f="GET";}else{f="POST";}d=new CH(1);g=new(BE)();g.onload=$externalize((function(){var $ptr,h,i;h="";i=g.responseText;if(!(i===undefined)&&!(i===null)){h=$internalize(i,$String);}$go((function $b(){var $ptr,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=$send(d,h);$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.$s=$s;$f.$r=$r;return $f;}),[]);}),BN);g.onprogress=$externalize((function(){var $ptr;}),BN);g.ontimeout=$externalize((function(){var $ptr;$go((function(){var $ptr;$close(d);}),[]);}),BN);g.onerror=$externalize((function(){var $ptr;$go((function $b(){var $ptr,$s,$r;$s=0;var $f,$c=false;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$ptr=$f.$ptr;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=$send(d,"");$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$s=-1;case-1:}return;}if($f===undefined){$f={$blk:$b};}$f.$ptr=$ptr;$f.$s=$s;$f.$r=$r;return $f;}),[]);}),BN);g.open($externalize(f,$String),$externalize(a,$String));g.timeout=$externalize(c,AS);if(!(b==="")&&BF){g.setRequestHeader($externalize("Content-Type",$String),$externalize("application/json",$String));}g.send($externalize(b,$String));return[d,e];}catch(err){$err=err;}finally{$callDeferred($deferred,$err);if(!$curGoroutine.asleep){return[d,e];}}};$pkg.XHR=BH;BI=function(a,b,c){var $ptr,a,b,c,d,e,f,g,h;d=CH.nil;e=$ifaceNil;f=AA(b);g=f[0];e=f[1];if(!($interfaceIsEqual(e,$ifaceNil))){return[d,e];}h=BH(a,g,c);d=h[0];e=h[1];return[d,e];};$pkg.XHR_JSON=BI;BY.methods=[{prop:"Name",name:"Name",pkg:"",typ:$funcType([],[$String],false)}];CI.methods=[{prop:"Success",name:"Success",pkg:"",typ:$funcType([],[],false)},{prop:"Failure",name:"Failure",pkg:"",typ:$funcType([AS],[AS],false)}];BU.methods=[{prop:"then",name:"then",pkg:"ninchatclient",typ:$funcType([BQ,BQ,BQ],[],false)},{prop:"Resolve",name:"Resolve",pkg:"",typ:$funcType([BL],[],true)},{prop:"Reject",name:"Reject",pkg:"",typ:$funcType([BL],[],true)},{prop:"Notify",name:"Notify",pkg:"",typ:$funcType([BL],[],true)}];CJ.methods=[{prop:"OnSessionEvent",name:"OnSessionEvent",pkg:"",typ:$funcType([BQ],[],false)},{prop:"OnEvent",name:"OnEvent",pkg:"",typ:$funcType([BQ],[],false)},{prop:"OnConnState",name:"OnConnState",pkg:"",typ:$funcType([BQ],[],false)},{prop:"OnConnActive",name:"OnConnActive",pkg:"",typ:$funcType([BQ],[],false)},{prop:"OnLog",name:"OnLog",pkg:"",typ:$funcType([BQ],[],false)},{prop:"SetParams",name:"SetParams",pkg:"",typ:$funcType([CB],[],false)},{prop:"SetTransport",name:"SetTransport",pkg:"",typ:$funcType([BQ],[],false)},{prop:"SetAddress",name:"SetAddress",pkg:"",typ:$funcType([BQ],[],false)},{prop:"Open",name:"Open",pkg:"",typ:$funcType([],[],false)},{prop:"Close",name:"Close",pkg:"",typ:$funcType([],[],false)},{prop:"Send",name:"Send",pkg:"",typ:$funcType([BQ,BQ],[$emptyInterface],false)},{prop:"send",name:"send",pkg:"ninchatclient",typ:$funcType([BY],[],false)},{prop:"sendAck",name:"sendAck",pkg:"ninchatclient",typ:$funcType([],[],false)},{prop:"discover",name:"discover",pkg:"ninchatclient",typ:$funcType([],[],false)},{prop:"connect",name:"connect",pkg:"ninchatclient",typ:$funcType([AO,BJ,CI],[$Bool],false)},{prop:"canLogin",name:"canLogin",pkg:"ninchatclient",typ:$funcType([],[$Bool],false)},{prop:"makeCreateSessionAction",name:"makeCreateSessionAction",pkg:"ninchatclient",typ:$funcType([],[BQ],false)},{prop:"makeResumeSessionAction",name:"makeResumeSessionAction",pkg:"ninchatclient",typ:$funcType([$Bool],[BQ],false)},{prop:"handleSessionEvent",name:"handleSessionEvent",pkg:"ninchatclient",typ:$funcType([BQ],[$Bool],false)},{prop:"handleEvent",name:"handleEvent",pkg:"ninchatclient",typ:$funcType([BQ,BQ],[$Uint64,$Bool,$Bool,$Bool],false)},{prop:"connState",name:"connState",pkg:"ninchatclient",typ:$funcType([$String],[],false)},{prop:"connActive",name:"connActive",pkg:"ninchatclient",typ:$funcType([],[],false)},{prop:"log",name:"log",pkg:"ninchatclient",typ:$funcType([BL],[],true)}];CE.methods=[{prop:"Active",name:"Active",pkg:"",typ:$funcType([],[$Bool],false)},{prop:"Reset",name:"Reset",pkg:"",typ:$funcType([AS],[],false)},{prop:"Stop",name:"Stop",pkg:"",typ:$funcType([],[],false)}];CF.methods=[{prop:"Send",name:"Send",pkg:"",typ:$funcType([$emptyInterface],[$error],false)},{prop:"SendJSON",name:"SendJSON",pkg:"",typ:$funcType([$emptyInterface],[$error],false)},{prop:"Receive",name:"Receive",pkg:"",typ:$funcType([],[BQ,$error],false)},{prop:"ReceiveJSON",name:"ReceiveJSON",pkg:"",typ:$funcType([],[BQ,$error],false)},{prop:"Close",name:"Close",pkg:"",typ:$funcType([],[$error],false)}];D.init([{prop:"Id",name:"Id",pkg:"",typ:$Uint64,tag:""},{prop:"Header",name:"Header",pkg:"",typ:BQ,tag:""},{prop:"Payload",name:"Payload",pkg:"",typ:BQ,tag:""},{prop:"Deferred",name:"Deferred",pkg:"",typ:BU,tag:""},{prop:"name",name:"name",pkg:"ninchatclient",typ:$String,tag:""}]);L.init([{prop:"lastSlot",name:"lastSlot",pkg:"ninchatclient",typ:$Int,tag:""}]);AL.init([{prop:"resolve",name:"resolve",pkg:"ninchatclient",typ:BV,tag:""},{prop:"reject",name:"reject",pkg:"ninchatclient",typ:BV,tag:""},{prop:"notify",name:"notify",pkg:"ninchatclient",typ:BV,tag:""}]);AO.init([CJ,$String],[$Bool,$Bool],false);AP.init([{prop:"onSessionEvent",name:"onSessionEvent",pkg:"ninchatclient",typ:BQ,tag:""},{prop:"onEvent",name:"onEvent",pkg:"ninchatclient",typ:BQ,tag:""},{prop:"onConnState",name:"onConnState",pkg:"ninchatclient",typ:BQ,tag:""},{prop:"onConnActive",name:"onConnActive",pkg:"ninchatclient",typ:BQ,tag:""},{prop:"onLog",name:"onLog",pkg:"ninchatclient",typ:BQ,tag:""},{prop:"address",name:"address",pkg:"ninchatclient",typ:$String,tag:""},{prop:"forceLongPoll",name:"forceLongPoll",pkg:"ninchatclient",typ:$Bool,tag:""},{prop:"sessionParams",name:"sessionParams",pkg:"ninchatclient",typ:CB,tag:""},{prop:"sessionId",name:"sessionId",pkg:"ninchatclient",typ:BQ,tag:""},{prop:"latestConnState",name:"latestConnState",pkg:"ninchatclient",typ:$String,tag:""},{prop:"latestConnActive",name:"latestConnActive",pkg:"ninchatclient",typ:AR,tag:""},{prop:"lastActionId",name:"lastActionId",pkg:"ninchatclient",typ:$Uint64,tag:""},{prop:"sendNotify",name:"sendNotify",pkg:"ninchatclient",typ:BX,tag:""},{prop:"sendBuffer",name:"sendBuffer",pkg:"ninchatclient",typ:BZ,tag:""},{prop:"numSent",name:"numSent",pkg:"ninchatclient",typ:$Int,tag:""},{prop:"sendEventAck",name:"sendEventAck",pkg:"ninchatclient",typ:$Bool,tag:""},{prop:"receivedEventId",name:"receivedEventId",pkg:"ninchatclient",typ:$Uint64,tag:""},{prop:"ackedEventId",name:"ackedEventId",pkg:"ninchatclient",typ:$Uint64,tag:""},{prop:"closeNotify",name:"closeNotify",pkg:"ninchatclient",typ:BX,tag:""},{prop:"closed",name:"closed",pkg:"ninchatclient",typ:$Bool,tag:""},{prop:"stopped",name:"stopped",pkg:"ninchatclient",typ:$Bool,tag:""}]);AU.init([{prop:"C",name:"C",pkg:"",typ:BX,tag:""},{prop:"id",name:"id",pkg:"ninchatclient",typ:BQ,tag:""}]);AX.init([{prop:"Notify",name:"Notify",pkg:"",typ:BX,tag:""},{prop:"GoingAway",name:"GoingAway",pkg:"",typ:$Bool,tag:""},{prop:"impl",name:"impl",pkg:"ninchatclient",typ:BQ,tag:""},{prop:"open",name:"open",pkg:"ninchatclient",typ:$Bool,tag:""},{prop:"error",name:"error",pkg:"ninchatclient",typ:$error,tag:""},{prop:"buffer",name:"buffer",pkg:"ninchatclient",typ:BV,tag:""}]);$init=function(){$pkg.$init=function(){};var $f,$c=false,$s=0,$r;if(this!==undefined&&this.$blk!==undefined){$f=this;$c=true;$s=$f.$s;$r=$f.$r;}s:while(true){switch($s){case 0:$r=A.$init();$s=1;case 1:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=B.$init();$s=2;case 2:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}$r=C.$init();$s=3;case 3:if($c){$c=false;$r=$r.$blk();}if($r&&$r.$blk!==undefined){break s;}BE=null;BF=false;AJ=X();AN=P(new $Uint64(0,4096),-0.25);$pkg.WebSocketSupported=!($global.WebSocket===undefined);BG();AK();}return;}if($f===undefined){$f={$blk:$init};}$f.$s=$s;$f.$r=$r;return $f;};$pkg.$init=$init;return $pkg;})();
$synthesizeMethods();
$packages["runtime"].$init();
$go($packages["ninchatclient"].$init, [], true);
$flushConsole();

}).call(this);
//# sourceMappingURL=ninchatclient.min.js.map
